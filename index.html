<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APPLE : The Invitation from Adam</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    
    <style>
        /* --- 초기화 및 기본 설정 --- */
        :root {
            --bg-color: #050505;
            --text-main: #d0d0d0;
            --text-dim: #777777;
            --accent-color: #cfcfcf;
            --border-color: #333333;
            --blood-color: #7a1a1a;
            --glitch-color: #ff0000;
            --font-kr: 'Nanum Myeongjo', serif;
            --font-en: 'Playfair Display', serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-kr);
            line-height: 1.6;
            overflow-x: hidden;
            font-size: 16px;
            position: relative;
            transition: transform 0.1s, filter 0.1s;
        }

        body.destroyed {
            transform: rotate(0.5deg) scale(1.01);
            filter: contrast(1.3) brightness(0.7) blur(0.5px) grayscale(0.2);
            overflow: hidden;
        }

        /* 전체 화면 노이즈(스캔라인) 효과 */
        body::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(
                rgba(18, 16, 16, 0) 50%, 
                rgba(0, 0, 0, 0.25) 50%
            ), linear-gradient(
                90deg, 
                rgba(255, 0, 0, 0.06), 
                rgba(0, 255, 0, 0.02), 
                rgba(0, 0, 255, 0.06)
            );
            background-size: 100% 4px, 6px 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.6;
        }

        /* 산산조각 효과 오버레이 */
        .shatter-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-image: url('https://png.pngtree.com/png-vector/20230814/ourmid/pngtree-broken-glass-texture-realistic-cracked-glass-effect-overlay-vector-png-image_9479998.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: 120% 120%;
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            transform: scale(1.5);
            transition: opacity 0.05s ease-in, transform 0.1s cubic-bezier(0.1, 0.7, 0.1, 1);
            mix-blend-mode: hard-light;
            display: none;
        }
        
        .shatter-overlay.active {
            display: block;
            opacity: 1;
            transform: scale(1);
        }

        /* 섬광 효과 */
        .flash-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #fff;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
        }
        .flash-overlay.boom {
            animation: flashBang 0.2s ease-out forwards;
        }

        @keyframes flashBang {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        a { text-decoration: none; color: inherit; }
        ul { list-style: none; }

        /* 글리치 이펙트 */
        .glitch-active {
            animation: glitch-anim 0.15s infinite linear alternate-reverse;
            color: var(--glitch-color) !important;
            text-shadow: -2px 0 var(--blood-color), 2px 0 #fff;
            position: relative;
            display: inline-block;
        }

        @keyframes glitch-anim {
            0% { transform: translate(0) skewX(0deg); opacity: 1; filter: blur(0px); }
            20% { transform: translate(-3px, 2px) skewX(5deg); opacity: 0.8; }
            40% { transform: translate(3px, -2px) skewX(-5deg); filter: blur(1px); }
            60% { transform: translate(-3px, 1px) skewX(2deg); opacity: 0.9; }
            80% { transform: translate(2px, -3px) skewX(-2deg); }
            100% { transform: translate(0) skewX(0deg); opacity: 1; filter: blur(0px); }
        }

        /* 화면 흔들림 */
        .shake-screen {
            animation: violentShake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            background-color: #300 !important;
        }

        @keyframes violentShake {
            10%, 90% { transform: translate3d(-3px, 2px, 0) rotate(-1deg); }
            20%, 80% { transform: translate3d(5px, -3px, 0) rotate(1deg); }
            30%, 50%, 70% { transform: translate3d(-8px, 4px, 0) rotate(-2deg); }
            40%, 60% { transform: translate3d(8px, -4px, 0) rotate(2deg); }
        }

        /* 중간 문구 스타일 */
        .mid-phrase-container {
            text-align: center;
            margin: 80px 0;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
            z-index: 10;
        }
        .mid-phrase-container:hover {
            transform: scale(1.05);
        }
        .mid-phrase {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--blood-color);
            font-family: var(--font-kr);
            letter-spacing: 10px;
            text-shadow: 0 0 10px rgba(122, 26, 26, 0.5);
        }

        /* 레이아웃 유틸리티 */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .section-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
            margin: 60px 0;
        }

        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s ease, transform 1s ease;
        }
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- [수정] 이미지 플레이스홀더 (NO IMAGE 문제 해결) --- */
        .img-placeholder {
            background-color: #111;
            border: 1px dashed #444;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-family: var(--font-en);
            font-size: 0.8rem;
            overflow: hidden;
            position: relative;
        }
        .img-placeholder::after {
            content: 'NO IMAGE';
            position: absolute;
            transform: rotate(-45deg);
            z-index: 0; /* 이미지 뒤로 */
        }
        .img-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            position: relative;
            z-index: 1; /* 가상 요소보다 앞으로 */
            background-color: #111; /* 이미지가 로드되면 불투명해져서 뒤를 가림 */
        }

        /* 헤더 */
        header {
            text-align: center;
            padding: 80px 0 40px;
            border-bottom: 2px double var(--border-color);
            margin-bottom: 40px;
        }

        h1 {
            font-family: var(--font-en);
            font-size: 4rem;
            letter-spacing: 5px;
            margin-bottom: 10px;
            color: var(--accent-color);
            text-shadow: 2px 2px 5px rgba(0,0,0,0.8);
        }

        .subtitle {
            font-family: var(--font-en);
            font-size: 1.2rem;
            color: var(--text-dim);
            font-style: italic;
        }

        /* 편지 섹션 */
        .letter-section {
            background-color: #0e0e0e;
            padding: 40px;
            border: 1px solid var(--border-color);
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            margin-bottom: 60px;
            position: relative;
        }
        
        .letter-section::before {
            content: '"';
            position: absolute;
            top: -20px;
            left: 20px;
            font-size: 6rem;
            font-family: var(--font-en);
            color: #1a1a1a;
            z-index: 0;
        }

        #typewriter {
            position: relative;
            z-index: 1;
            white-space: pre-wrap;
            font-size: 1.1rem;
            color: #ccc;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: #ccc;
            animation: blink 1s infinite;
        }

        @keyframes blink { 50% { opacity: 0; } }

        /* 신문 기사 섹션 */
        .newspaper-section {
            background-color: #121212;
            padding: 30px;
            border: 1px solid #444;
            margin-bottom: 60px;
            font-family: var(--font-kr);
        }

        .news-header {
            border-bottom: 2px solid var(--text-dim);
            margin-bottom: 20px;
            padding-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        
        .news-title {
            font-family: var(--font-en);
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-main);
            text-transform: uppercase;
        }

        .news-date {
            font-family: var(--font-en);
            color: var(--text-dim);
            font-style: italic;
        }

        .news-content {
            column-count: 2;
            column-gap: 40px;
            font-size: 0.95rem;
            color: #aaa;
            text-align: justify;
            line-height: 1.8;
        }
        
        .news-content p { margin-bottom: 15px; }

        .news-highlight {
            font-weight: bold;
            color: var(--blood-color);
            font-family: var(--font-en);
            font-size: 1.1rem;
            float: left;
            margin-right: 10px;
            line-height: 1;
        }

        /* 세계관 섹션 */
        .worldview-section {
            border-left: 2px solid var(--blood-color);
            padding: 20px 20px 20px 30px;
            background: linear-gradient(90deg, rgba(20,0,0,0.3), transparent);
            margin-bottom: 60px;
        }
        
        .worldview-title {
            font-family: var(--font-en);
            font-size: 1.8rem;
            color: var(--accent-color);
            margin-bottom: 15px;
        }

        .worldview-text {
            color: var(--text-dim);
            font-size: 1rem;
            line-height: 1.7;
        }

        /* 착란과 광기 섹션 */
        .sanity-section {
            background-color: #080000;
            border: 1px solid var(--blood-color);
            padding: 30px;
            margin-bottom: 60px;
            position: relative;
            box-shadow: inset 0 0 50px rgba(50, 0, 0, 0.3);
        }

        .sanity-title {
            font-family: var(--font-en);
            font-size: 2rem;
            color: var(--blood-color);
            margin-bottom: 20px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .sanity-meter-box {
            width: 100%;
            height: 40px;
            background: #111;
            border: 1px solid #444;
            margin: 30px 0;
            position: relative;
        }

        .sanity-bar {
            height: 100%;
            background: linear-gradient(90deg, #1a4a1a 0%, #3a3a1a 40%, #5a1a1a 100%);
            width: 100%;
            position: relative;
        }
        
        .sanity-marker {
            position: absolute;
            top: -25px;
            height: 75px;
            width: 1px;
            background-color: #fff;
            z-index: 5;
            opacity: 0.7;
            font-family: var(--font-en);
            font-size: 0.8rem;
        }
        .sanity-marker::after {
            content: attr(data-label);
            position: absolute;
            top: -15px;
            left: -10px;
            color: #aaa;
        }

        .sanity-desc-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
            border-top: 1px solid #222;
            padding-top: 20px;
        }
        
        .sanity-stage h4 {
            color: var(--text-main);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .sanity-stage p {
            color: var(--text-dim);
            font-size: 0.9rem;
        }
        
        .warning-text {
            color: var(--blood-color);
            font-weight: bold;
        }

        /* 도시 구역 (탭) */
        .districts-section h2 {
            font-family: var(--font-en);
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            display: inline-block;
            position: relative;
            left: 50%;
            transform: translateX(-50%);
        }

        .tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }

        .tab-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-dim);
            padding: 10px 20px;
            cursor: pointer;
            font-family: var(--font-kr);
            font-size: 1rem;
            transition: all 0.3s;
        }

        .tab-btn:hover, .tab-btn.active {
            background-color: var(--text-main);
            color: var(--bg-color);
            border-color: var(--text-main);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }

        .tab-content {
            display: none;
            background: #141414;
            padding: 30px;
            border: 1px solid var(--border-color);
            min-height: 200px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        /* --- [수정] 이미지 영역 노이즈 제거 (z-index 상향) --- */
        .district-img-box {
            width: 100%;
            height: 250px; /* 높이는 유지하되 */
            margin-bottom: 25px;
            border-radius: 2px;
            
            /* [수정 1] 이미지가 찌그러지지 않고 박스에 꽉 차게 */
            object-fit: cover; 
            
            /* [수정 2] 흑백 및 거친 필터 제거 (원래 코드 삭제) */
            /* filter: grayscale(100%) contrast(1.2); */

            /* [수정 3] TV 노이즈(스캔라인)보다 이미지 우선순위를 높여서 깨끗하게 보이게 함 */
            position: relative;
            z-index: 10000;
            box-shadow: 0 0 10px rgba(0,0,0,0.5); /* 약간의 그림자로 입체감 추가 */
        }

        .tab-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--accent-color);
            border-left: 3px solid var(--blood-color);
            padding-left: 15px;
        }

        .keyword { color: var(--blood-color); font-weight: bold; }

        /* 로턴 호텔 섹션 */
        .lawton-section {
            background-color: #0c0c0c;
            border: 1px solid var(--border-color);
            padding: 40px;
            margin-bottom: 60px;
            position: relative;
        }
        
        .lawton-title {
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 25px;
            color: var(--text-main);
            font-family: var(--font-kr);
        }
        .lawton-title span {
            font-family: var(--font-en);
            font-size: 1.8rem;
            color: var(--text-dim);
            margin-left: 10px;
        }

        .hotel-intro-text {
            column-count: 1;
            text-align: center;
            color: #999;
            line-height: 1.8;
            margin-top: 25px;
            font-size: 1rem;
        }

        .hotel-features {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
            border-top: 1px solid #222;
            padding-top: 20px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .feature-item {
            text-align: center;
        }
        .feature-icon {
            font-family: var(--font-en);
            font-size: 1.5rem;
            color: var(--accent-color);
            display: block;
            margin-bottom: 5px;
        }
        .feature-desc {
            font-size: 0.9rem;
            color: #666;
        }

        /* --- [수정] 이미지 영역 노이즈 제거 --- */
        .hotel-main-img {
            width: 100%;
            height: 300px;
            border-radius: 2px;
            filter: sepia(30%) grayscale(50%) contrast(1.1);
            position: relative;
            z-index: 10000;
        }

        /* 호텔 및 해결사 명부 */
        .hotel-section { margin-top: 50px; }
        .hotel-section h2 {
            font-family: var(--font-en);
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .hotel-desc {
            text-align: center;
            color: var(--text-dim);
            margin-bottom: 40px;
        }

        .guest-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .guest-card {
            background: #0f0f0f;
            border: 1px solid var(--border-color);
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }

        .guest-card:hover {
            border-color: var(--blood-color);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(20, 0, 0, 0.5);
            background: #161010;
        }

        /* --- [수정] 이미지 영역 노이즈 제거 --- */
        .card-img-box {
            width: 100px;
            height: 120px;
            flex-shrink: 0;
            filter: sepia(50%) grayscale(80%);
            position: relative;
            z-index: 10000;
        }

        .room-number {
            font-family: var(--font-en);
            font-size: 3.5rem;
            color: #1a1a1a;
            position: absolute;
            bottom: -10px;
            right: 0px;
            z-index: 0;
            line-height: 1;
            pointer-events: none;
        }

        .guest-info { position: relative; z-index: 1; flex-grow: 1; }
        .guest-name {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--text-main);
            font-family: var(--font-kr);
        }
        .guest-role {
            font-size: 0.9rem;
            color: var(--blood-color);
            font-weight: bold;
            font-style: italic;
            margin-bottom: 10px;
            display: block;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
            width: 100%;
        }
        .guest-details {
            font-size: 0.9rem;
            color: #aaa;
            line-height: 1.5;
        }

        .user-card {
            border: 1px dashed var(--blood-color);
            background: rgba(40, 0, 0, 0.1);
        }
        .user-card .guest-name { color: var(--blood-color); }

        /* 고급 명함 팝업창 (Modal) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            z-index: 10005;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .business-card {
            width: 700px;
            max-width: 90%;
            background: #111;
            border: 1px solid #333;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.9);
            padding: 40px;
            display: flex;
            gap: 30px;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            font-family: var(--font-kr);
        }
        .modal-overlay.active .business-card {
            transform: translateY(0);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            color: #555;
            font-size: 1.5rem;
            cursor: pointer;
            font-family: var(--font-en);
            transition: color 0.3s;
        }
        .close-btn:hover { color: var(--blood-color); }

        .card-info-side {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .card-header {
            border-bottom: 2px solid var(--blood-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
        }
        .card-name {
            font-size: 2rem;
            color: var(--text-main);
            font-weight: bold;
            margin-bottom: 5px;
        }
        .card-role {
            font-size: 1.1rem;
            color: var(--text-dim);
            font-style: italic;
            font-family: var(--font-en);
        }

        .card-body-row {
            display: flex;
            margin-bottom: 12px;
            font-size: 0.95rem;
            align-items: baseline;
        }
        .card-label {
            width: 80px;
            color: #666;
            font-weight: bold;
            flex-shrink: 0;
        }
        .card-value {
            color: #ccc;
        }

        .redacted {
            background-color: #000;
            color: #000;
            padding: 0 5px;
            position: relative;
            user-select: none;
        }
        .redacted::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: repeating-linear-gradient(
                45deg,
                rgba(20,20,20,0.8),
                rgba(20,20,20,0.8) 2px,
                #000 2px,
                #000 4px
            );
            pointer-events: none;
        }

        .card-img-side {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-left: 1px solid #222;
            padding-left: 30px;
        }
        
        /* --- [수정] 이미지 영역 노이즈 제거 --- */
        .card-portrait-box {
            width: 100%;
            height: 250px;
            border: 1px solid #333;
            background: #080808;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            position: relative;
            z-index: 10000;
        }
        .card-room-number {
            font-family: var(--font-en);
            font-size: 2.5rem;
            color: #222;
            font-weight: bold;
        }

        /* 안개 효과 */
        .fog-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 300px;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
            opacity: 0.4;
        }
        .fog-img {
            position: absolute;
            height: 100vh;
            width: 300vw;
            z-index: 1;
            opacity: 0.6;
            background: url('https://raw.githubusercontent.com/danielstuart14/CSS_FOG_ANIMATION/master/fog1.png') repeat-x;
            background-size: contain;
            animation: fog 60s linear infinite;
        }
        .fog-img-2 {
            z-index: 2;
            background: url('https://raw.githubusercontent.com/danielstuart14/CSS_FOG_ANIMATION/master/fog2.png') repeat-x;
            background-size: contain;
            animation: fog 40s linear infinite;
            margin-left: -50%;
        }

        @keyframes fog {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-200vw, 0, 0); }
        }

        /* 푸터 */
        footer {
            text-align: center;
            padding: 60px 0;
            color: #555;
            font-size: 0.8rem;
            margin-top: 40px;
            border-top: 1px solid #1a1a1a;
            position: relative;
            z-index: 2;
        }

        /* 반응형 */
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            .tabs { flex-direction: column; }
            .tab-btn { width: 100%; text-align: center; }
            .newspaper-section .news-content { column-count: 1; } 
            .sanity-desc-grid { grid-template-columns: 1fr; }
            
            .guest-grid { grid-template-columns: 1fr; }
            .guest-card {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .card-img-box {
                width: 120px;
                height: 150px;
                margin-bottom: 15px;
            }
            .room-number {
                top: 10px;
                right: 15px;
                bottom: auto;
                font-size: 2rem;
                color: #222;
            }
            .business-card {
                flex-direction: column-reverse;
                width: 90%;
                padding: 20px;
            }
            .card-img-side {
                border-left: none;
                padding-left: 0;
                margin-bottom: 20px;
                border-bottom: 1px solid #222;
                padding-bottom: 20px;
            }
            .card-portrait-box { height: 200px; }
        }

        /* --- [추가] 비밀 전송(Input) 섹션 스타일 --- */
        .input-section {
            margin-top: 60px;
            margin-bottom: 60px;
            padding: 40px;
            border: 1px solid #333;
            background: linear-gradient(180deg, #0a0a0a 0%, #111 100%);
            text-align: center;
            position: relative;
        }

        .input-title {
            font-family: var(--font-en);
            font-size: 1.8rem;
            color: var(--text-dim);
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        .terminal-box {
            position: relative;
            max-width: 600px;
            margin: 0 auto;
        }

        /* 텍스트 입력 영역 (타자기 느낌) */
        .terminal-input {
            width: 100%;
            height: 150px;
            background-color: #050505;
            border: 1px solid #444;
            color: #ddd;
            font-family: var(--font-kr);
            font-size: 1rem;
            padding: 20px;
            resize: none; /* 크기 조절 불가 */
            outline: none;
            transition: border-color 0.3s;
        }
        .terminal-input:focus {
            border-color: var(--blood-color);
            box-shadow: 0 0 10px rgba(122, 26, 26, 0.3);
        }
        .terminal-input::placeholder {
            color: #444;
            font-style: italic;
        }

        /* 전송 버튼 */
        .transmit-btn {
            margin-top: 20px;
            background: transparent;
            border: 1px solid var(--text-dim);
            color: var(--text-dim);
            padding: 10px 40px;
            font-family: var(--font-en);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        .transmit-btn:hover {
            background-color: var(--blood-color);
            border-color: var(--blood-color);
            color: #fff;
            box-shadow: 0 0 15px var(--blood-color);
        }

        /* 전송 결과 메시지 */
        .response-msg {
            margin-top: 20px;
            min-height: 24px;
            font-size: 0.9rem;
            color: var(--accent-color);
            font-family: monospace; /* 기계적인 느낌 */
            opacity: 0;
            transition: opacity 0.5s;
        }
        .response-msg.show {
            opacity: 1;
        }

        /* --- [수정/리뉴얼] 시크릿 인터페이스 (Dark UI) --- */
        .secret-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.95); /* 거의 불투명한 검정 */
            z-index: 20000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            backdrop-filter: blur(5px);
        }
        .secret-overlay.open {
            display: flex;
            opacity: 1;
        }

        .secret-interface {
            width: 900px;
            max-width: 95%;
            height: 80vh;
            background-color: #080808;
            border: 1px solid var(--blood-color); /* 붉은 테두리 */
            box-shadow: 0 0 30px rgba(122, 26, 26, 0.2);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* 헤더 영역 */
        .secret-header-bar {
            padding: 20px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(90deg, #111, #080808);
        }
        .secret-title {
            font-family: var(--font-en);
            font-size: 2rem;
            color: var(--blood-color);
            letter-spacing: 5px;
            font-weight: bold;
            text-shadow: 0 0 5px var(--blood-color);
        }

        /* 탭 네비게이션 */
        .secret-tabs {
            display: flex;
            border-bottom: 1px solid #333;
            background-color: #111;
        }
        .secret-tab-btn {
            flex: 1;
            padding: 15px;
            background: transparent;
            border: none;
            border-right: 1px solid #333;
            color: #666;
            font-family: var(--font-kr);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        .secret-tab-btn:last-child { border-right: none; }
        .secret-tab-btn:hover {
            background-color: #1a1a1a;
            color: #ccc;
        }
        .secret-tab-btn.active {
            background-color: var(--blood-color);
            color: #fff;
            font-weight: bold;
        }

        /* 컨텐츠 영역 */
        .secret-body {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            color: #ccc;
            font-family: var(--font-kr);
        }

        .secret-chapter {
            display: none;
            animation: fadeIn 0.5s;
        }
        .secret-chapter.active { display: block; }

        .chapter-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--text-main);
            border-left: 3px solid var(--blood-color);
            padding-left: 15px;
        }

        .secret-img-box {
            width: 100%;
            height: 300px;
            margin-bottom: 25px;
            border: 1px solid #333;
            filter: grayscale(80%) contrast(1.2) brightness(0.8);
        }

        .secret-text p {
            margin-bottom: 15px;
            line-height: 1.8;
            color: #999;
        }
        .secret-highlight {
            color: var(--blood-color);
            font-weight: bold;
        }

        /* 닫기 버튼 */
        .secret-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: 1px solid #555;
            color: #555;
            padding: 5px 15px;
            cursor: pointer;
            font-family: var(--font-en);
            transition: all 0.3s;
        }
        .secret-close-btn:hover {
            border-color: var(--blood-color);
            color: var(--blood-color);
        }

        /* --- [추가] 희생(SACRIFICE) 모드 스타일 --- */
        .sacrifice-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background-color: #000;
            z-index: 21000; /* Forbidden보다 더 위 */
            display: none;
            flex-direction: column;
            padding: 40px;
            overflow: hidden;
        }
        .sacrifice-overlay.open { display: flex; }

        /* 상단 네비게이션 */
        .sacrifice-nav {
            border-bottom: 2px solid #444;
            padding-bottom: 15px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .sacrifice-title {
            font-family: var(--font-en);
            font-size: 1.5rem;
            color: #ccc;
        }
        .sacrifice-close {
            background: none; border: 1px solid #444;
            color: #666; padding: 5px 15px; cursor: pointer;
            transition: 0.3s;
        }
        .sacrifice-close:hover { border-color: red; color: red; }

        /* 1. 파일 목록 화면 */
        .file-list-view {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            overflow-y: auto;
            flex: 1;
        }
        
        .file-folder-btn {
            background: #111;
            border: 1px solid #333;
            padding: 20px;
            color: #aaa;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s;
        }
        .file-folder-btn:hover {
            background: #1a1a1a;
            border-color: var(--accent-color);
            color: #fff;
            transform: translateY(-2px);
        }
       
        /* --- [수정] 폴더 이미지 컨테이너 스타일 --- */
        .folder-img-box {
            width: 80px;
            height: 80px;
            margin-bottom: 15px;
            border: 1px solid #444;
            background-color: #0a0a0a; /* 이미지가 없을 때 배경색 */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            border-radius: 4px; /* 약간의 둥근 모서리 */
        }

        .folder-img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* 이미지가 비율을 유지하며 꽉 차게 */
            filter: grayscale(50%); /* 약간의 흑백 톤 추가 (분위기용) */
            transition: filter 0.3s;
        }
        
        /* 호버 시 이미지 컬러 복원 */
        .file-folder-btn:hover .folder-img {
            filter: grayscale(0%);
        }

        /* 이미지가 없을 때 표시할 기본 아이콘 (선택사항) */
        .folder-img-box.no-img::after {
            content: 'No Image';
            color: #444;
            font-size: 0.7rem;
            font-family: var(--font-en);
        }

        /* 2. 상세(위키) 화면 */
        .file-detail-view {
            display: none; /* 기본 숨김 */
            flex: 1;
            flex-direction: column;
            overflow-y: auto;
            color: #ddd;
        }
        .file-detail-view.active { display: flex; }

        .wiki-layout {
            display: flex;
            gap: 40px;
            margin-top: 20px;
        }
        
        /* 위키 사이드바 (이미지 + 기본정보) */
        .wiki-sidebar {
            flex: 1;
            max-width: 300px;
            background: #0a0a0a;
            border: 1px solid #333;
            padding: 20px;
            height: fit-content;
        }
        .wiki-img-box {
            width: 100%; height: 350px;
            border: 1px solid #444;
            margin-bottom: 20px;
            background: #000;
        }
        .wiki-info-row {
            display: flex; justify-content: space-between;
            border-bottom: 1px solid #222;
            padding: 8px 0;
            font-size: 0.9rem;
        }
        .wiki-label { color: #666; font-weight: bold; }

        /* 위키 메인 컨텐츠 (평가) */
        .wiki-content {
            flex: 2;
            padding-right: 20px;
        }
        .wiki-name-title {
            font-size: 2.5rem;
            border-bottom: 2px solid var(--blood-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            font-family: var(--font-kr);
        }
        .wiki-section-title {
            font-size: 1.3rem;
            color: var(--accent-color);
            margin-top: 30px; margin-bottom: 15px;
            border-left: 4px solid #444;
            padding-left: 10px;
            background: rgba(255,255,255,0.05);
        }
        .wiki-text {
            line-height: 1.8;
            color: #aaa;
            text-align: justify;
        }

        .back-btn {
            background: #222; border: none; color: #ccc;
            padding: 10px 20px; cursor: pointer;
            margin-bottom: 20px; width: fit-content;
        }
        .back-btn:hover { background: #333; }

        @media (max-width: 768px) {
            .wiki-layout { flex-direction: column; }
            .wiki-sidebar { max-width: 100%; }
        }

/* --- [추가] 위키 상세 페이지 확장 스타일 --- */
        
        /* 1. 금기와 신념 */
        .wiki-belief-quote {
            font-family: var(--font-kr);
            font-size: 1.2rem;
            font-weight: bold;
            color: #ddd;
            border-left: 3px solid var(--blood-color);
            padding-left: 15px;
            margin: 20px 0 10px 0;
            font-style: italic;
        }
        .wiki-belief-desc {
            color: #888; margin-bottom: 30px; font-size: 0.95rem;
        }

        /* 2. 신문 스크랩 효과 */
        .wiki-news-container {
            background-color: #1a1a1a;
            padding: 20px;
            border: 1px dashed #444;
            margin-bottom: 30px;
            position: relative;
        }
        .news-scrap {
            background: #e0e0d0; /* 누런 종이 색 */
            color: #111;
            padding: 10px;
            font-family: var(--font-kr);
            font-size: 0.85rem;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
            margin-bottom: 10px;
            transform: rotate(-1deg); /* 약간 삐뚤어지게 */
            width: fit-content;
            max-width: 100%;
        }
        .news-scrap:nth-child(even) { transform: rotate(1deg); margin-left: auto; }
        .news-header-small {
            font-size: 0.7rem; font-weight: bold; border-bottom: 1px solid #000; display: block; margin-bottom: 5px;
        }

        /* --- [수정] 3. 개인 소지품 (위아래 선으로 감싸는 디자인) --- */
        .belongings-section-wrapper {
            margin-bottom: 40px;
        }

        .belongings-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }

        /* 소지품 박스 (좌우) */
        .belonging-item {
            width: 80px;
            height: 80px;
            border: 1px solid #555;
            background: #000;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            z-index: 2;
            box-shadow: 0 0 10px rgba(0,0,0,0.8);
        }
        .belonging-img {
            width: 100%; height: 100%; object-fit: cover;
            filter: grayscale(50%); transition: 0.3s;
        }
        .belonging-item:hover { border-color: var(--blood-color); }
        .belonging-item:hover .belonging-img { filter: grayscale(0%); transform: scale(1.1); }

        /* 중앙 연결부 (Flex Column으로 위-중간-아래 배치) */
        .belonging-connector {
            flex: 1;
            height: 80px; /* 양옆 박스 높이와 맞춤 */
            display: flex;
            flex-direction: column; /* 세로 정렬 */
            justify-content: center; /* 중앙 집중 */
            gap: 8px; /* 선과 글자 사이 간격 */
        }

        /* 위/아래 가로선 스타일 */
        .connector-line {
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #555 10%, #555 90%, transparent);
            opacity: 0.7;
        }

        /* 텍스트 영역 (선 사이 공간) */
        .item-text-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center; /* 텍스트 세로 중앙 정렬 */
            width: 100%;
            padding: 0 5px;
            box-sizing: border-box;
        }

        /* 텍스트 상세 */
        .item-info {
            display: flex;
            flex-direction: column;
            max-width: 48%;
            font-family: var(--font-kr);
        }
        .item-info.right { text-align: right; align-items: flex-end; }
        .item-info.left { text-align: left; align-items: flex-start; }

        .item-name {
            font-size: 0.9rem;
            color: var(--text-main);
            font-weight: bold;
            margin-bottom: 3px;
            letter-spacing: -0.5px;
        }
        .item-desc {
            font-size: 0.7rem;
            color: #888;
            line-height: 1.2;
            word-break: keep-all; /* 단어 단위 줄바꿈 */
        }

        /* --- [추가] 위험도 & 활용 가치 박스 --- */
        .status-matrix {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2열 배치 */
            gap: 20px;
            background: #111;
            border: 1px solid #333;
            padding: 20px;
            margin-top: 30px;
            margin-bottom: 10px;
        }
        .status-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .status-label {
            color: var(--blood-color);
            font-weight: bold;
            font-size: 0.9rem;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
            margin-bottom: 5px;
            font-family: var(--font-en);
        }
        .status-value {
            color: #ddd;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        /* 모바일 대응 */
        @media (max-width: 768px) {
            .status-matrix { grid-template-columns: 1fr; }
        }

        /* 4. 특성 및 종합 역량 */
        .capability-box {
            border: 1px solid #333;
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            color: #aaa;
            font-size: 0.95rem;
            margin-bottom: 20px;
        }

        /* 5. 마지막 요구사항 강조 */
        .final-request-box {
            margin-top: 40px;
            padding: 20px;
            border-top: 2px dashed var(--blood-color);
            text-align: right;
            color: var(--blood-color);
            font-family: var(--font-kr);
            font-weight: bold;
            font-size: 1.1rem;
        }

/* --- [추가] 시스템: 관찰과 추론 섹션 스타일 --- */
        .deduction-section {
            padding: 40px 20px;
            background-color: #0b0b0b;
            border-top: 1px solid #222;
            border-bottom: 1px solid #222;
            margin-bottom: 60px;
            text-align: center;
        }

        .system-title {
            font-family: var(--font-kr);
            font-size: 2rem;
            color: var(--text-main);
            margin-bottom: 30px;
        }
        .system-title span {
            font-family: var(--font-en);
            font-size: 1.2rem;
            color: var(--blood-color);
            margin-left: 10px;
            letter-spacing: 2px;
        }

        .mechanic-container {
            display: flex;
            justify-content: center;
            align-items: stretch;
            gap: 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .mechanic-box {
            flex: 1;
            background: #111;
            border: 1px solid #333;
            padding: 30px;
            position: relative;
            transition: 0.3s;
        }
        .mechanic-box:hover {
            border-color: var(--accent-color);
            transform: translateY(-5px);
            background: #161616;
        }

        .mech-icon {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #555;
            display: block;
        }

        .mech-header {
            font-size: 2.2rem; /* 1.4rem에서 2.2rem으로 크게 확대 */
            font-weight: bold;
            color: var(--blood-color);
            margin-bottom: 20px;
            border-bottom: 1px dashed #444;
            padding-bottom: 10px;
            display: inline-block;
            font-family: var(--font-kr); /* 명조체 적용 */
        }

        .mech-desc {
            color: #999;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        /* 관찰 예시 리스트 */
        .clue-list {
            text-align: left;
            background: #050505;
            padding: 15px;
            border-left: 2px solid #555;
        }
        .clue-item {
            color: #ccc;
            margin-bottom: 5px;
            font-family: monospace;
            font-size: 0.9rem;
        }
        .clue-item::before {
            content: '- ';
            color: var(--blood-color);
        }

        /* 추론 결과 박스 */
        .deduction-result {
            background-color: rgba(122, 26, 26, 0.1);
            border: 1px solid var(--blood-color);
            color: #d0d0d0;
            padding: 15px;
            font-style: italic;
            font-family: var(--font-kr);
        }

        /* 화살표 */
        .mechanic-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #444;
            animation: pulseArrow 2s infinite;
        }

        @keyframes pulseArrow {
            0% { opacity: 0.3; transform: translateX(0); }
            50% { opacity: 1; transform: translateX(5px); }
            100% { opacity: 0.3; transform: translateX(0); }
        }

        @media (max-width: 768px) {
            .mechanic-container { flex-direction: column; }
            .mechanic-arrow { transform: rotate(90deg); margin: 10px 0; }
            .mechanic-arrow { animation: none; } /* 모바일은 애니메이션 끔 */
        }

/* --- [추가] 3D 홀로그램 맵 스타일 --- */
        .map-section-container {
            margin-bottom: 80px;
            padding: 40px 0;
            background: radial-gradient(circle at center, #1a0505 0%, #000 70%);
            border-top: 1px solid #222;
            border-bottom: 1px solid #222;
            overflow: hidden;
            perspective: 1000px; /* 3D 원근감 */
        }

        .map-title {
            text-align: center;
            font-family: var(--font-en);
            color: var(--blood-color);
            margin-bottom: 40px;
            text-shadow: 0 0 10px var(--blood-color);
            letter-spacing: 3px;
        }

        /* 3D 스테이지 */
        .holo-stage {
            width: 400px;
            height: 400px;
            margin: 0 auto;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(60deg) rotateZ(-45deg); /* 아이소메트릭 뷰 */
            transition: transform 0.5s;
        }

        /* 도시 전체 그리드 바닥 */
        .holo-grid-base {
            position: absolute;
            width: 600px;
            height: 600px;
            top: -100px; left: -100px;
            background-image: 
                linear-gradient(rgba(122, 26, 26, 0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(122, 26, 26, 0.3) 1px, transparent 1px);
            background-size: 40px 40px;
            transform: translateZ(-20px);
            opacity: 0.3;
            pointer-events: none;
        }

        /* 구역 블록 공통 스타일 */
        .district-block {
            position: absolute;
            background: rgba(122, 26, 26, 0.1);
            border: 1px solid var(--blood-color);
            box-shadow: 0 0 15px rgba(122, 26, 26, 0.2) inset;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: var(--font-en);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            transform-style: preserve-3d;
        }

        /* 블록 호버 효과 (위로 떠오름 + 밝아짐) */
        .district-block:hover {
            background: rgba(122, 26, 26, 0.4);
            box-shadow: 0 0 30px var(--blood-color);
            transform: translateZ(20px);
            z-index: 10;
        }

        /* 라벨 (항상 정면을 보게 역회전 시킴 등은 생략하고 단순 텍스트로) */
        .d-label {
            transform: rotateZ(45deg) rotateX(-60deg) translateZ(20px); /* 텍스트가 서 보이게 */
            text-shadow: 0 0 5px #000;
            pointer-events: none;
            font-weight: bold;
        }

        /* --- 구역별 위치 및 크기 (맵 배치도) --- */
        
        /* 1. 중앙 (Center) */
        .d-center {
            width: 140px; height: 140px;
            top: 130px; left: 130px;
            z-index: 5;
            background: rgba(200, 50, 50, 0.15); /* 중앙은 좀 더 진하게 */
        }
        .d-center:hover { transform: translateZ(30px); }

        /* 2. 북부 (North) - 화면상 오른쪽 위 */
        .d-north {
            width: 300px; height: 100px;
            top: 10px; left: 50px;
        }

        /* 3. 남부 (South) - 화면상 왼쪽 아래 */
        .d-south {
            width: 300px; height: 100px;
            bottom: 10px; left: 50px;
        }

        /* 4. 서부 (West) - 화면상 왼쪽 위 */
        .d-west {
            width: 100px; height: 160px;
            top: 120px; left: 10px;
        }

        /* 5. 동부 (East) - 화면상 오른쪽 아래 */
        .d-east {
            width: 100px; height: 160px;
            top: 120px; right: 10px;
        }

        /* 스캔라인 (홀로그램 느낌) */
        .holo-scan {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(transparent, rgba(255, 0, 0, 0.2), transparent);
            opacity: 0.5;
            animation: scanMap 3s linear infinite;
            pointer-events: none;
            transform: translateZ(50px);
        }

        @keyframes scanMap {
            0% { transform: translateY(-100%) rotateZ(45deg); }
            100% { transform: translateY(400%) rotateZ(45deg); }
        }

        /* 모바일 대응 (축소) */
        @media (max-width: 768px) {
            .holo-stage { transform: scale(0.7) rotateX(60deg) rotateZ(-45deg); }
        }

/* =========================================
           [추가된 코드] 인트로 및 잠금 화면 스타일
           ========================================= */
        
        /* 1. 메인 화면 감싸는 래퍼 (처음엔 숨김) */
        #main-wrapper {
            display: none; 
            opacity: 0;
            transition: opacity 2s ease-in;
        }
        #main-wrapper.unlocked {
            display: block;
            opacity: 1;
        }

        /* 2. 인트로 오버레이 (심해 배경) */
        .intro-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: radial-gradient(circle at center, #0a0a0a 0%, #000000 100%);
            z-index: 99999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: opacity 1.5s ease-out, visibility 1.5s;
        }
        .intro-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* 3. 룬 문자 애니메이션 */
        .floating-rune {
            position: absolute;
            color: #444;
            font-size: 1.5rem;
            opacity: 0;
            user-select: none;
            text-shadow: 0 0 10px rgba(122, 26, 26, 0.3);
            animation: runeFloat linear forwards;
        }
        @keyframes runeFloat {
            0% { transform: translateY(110vh) translateX(0) rotate(0deg) scale(0.8); opacity: 0; }
            10% { opacity: 0.5; }
            50% { transform: translateY(50vh) translateX(20px) rotate(180deg) scale(1); opacity: 0.8; }
            90% { opacity: 0.5; }
            100% { transform: translateY(-10vh) translateX(-20px) rotate(360deg) scale(1.2); opacity: 0; }
        }

        /* 4. 불길한 청록색 빛 (단일, 느린 빈도) */
        .distant-light {
            position: absolute;
            width: 5px; 
            height: 5px;
            background-color: #00ffcc;
            border-radius: 50%;
            box-shadow: 0 0 15px #00ffcc, 0 0 30px #008b8b;
            opacity: 0;
            animation: flickerLight linear forwards;
            pointer-events: none;
        }
        @keyframes flickerLight {
            0% { opacity: 0; transform: scale(0.5); }
            20% { opacity: 0.8; transform: scale(1.2); }
            50% { opacity: 0.3; transform: scale(0.8); }
            80% { opacity: 0.9; transform: scale(1.1); }
            100% { opacity: 0; transform: scale(0.1); }
        }

        /* 5. 가라앉는 텍스트 */
        .sinking-text {
            color: #ddd;
            font-family: var(--font-en);
            font-size: 1.2rem;
            letter-spacing: 8px;
            text-align: center;
            animation: sinkText 14s ease-in-out forwards;
            opacity: 0;
            z-index: 10;
        }
        @keyframes sinkText {
            0% { opacity: 0; transform: translateY(30px) scale(0.9); filter: blur(4px); }
            10% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
            80% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
            100% { opacity: 0; transform: translateY(-50px) scale(1.1); filter: blur(10px); }
        }

        /* 6. 잠금 화면 */
        .lock-container {
            display: none;
            flex-direction: column;
            align-items: center;
            z-index: 11;
            animation: fadeInLock 2s ease-in;
        }
        @keyframes fadeInLock { from { opacity: 0; } to { opacity: 1; } }

        .rune-circle {
            width: 140px; height: 140px;
            border: 1px solid #222;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 40px;
            box-shadow: 0 0 30px rgba(0,0,0,0.9);
            position: relative;
        }
        .rune-circle::before {
            content: "";
            position: absolute;
            width: 100%; height: 100%;
            border-radius: 50%;
            border: 1px dashed var(--blood-color);
            border-top-color: transparent;
            animation: spinRune 8s infinite linear;
            opacity: 0.8;
        }
        .rune-icon {
            font-size: 4rem;
            color: var(--blood-color);
            text-shadow: 0 0 15px var(--blood-color);
            animation: pulseRune 3s infinite alternate;
        }
        @keyframes spinRune { 100% { transform: rotate(360deg); } }
        @keyframes pulseRune { from { opacity: 0.6; } to { opacity: 1; } }

        /* 7. 입력창 */
        .secret-input-box { width: 300px; text-align: center; position: relative; }
        .secret-input {
            background: transparent;
            border: none;
            border-bottom: 2px solid #333;
            color: #fff;
            font-family: var(--font-en);
            font-size: 1.5rem;
            width: 100%;
            text-align: center;
            padding: 10px;
            outline: none;
            letter-spacing: 5px;
            text-transform: uppercase;
            transition: 0.3s;
        }
        .secret-input:focus { border-bottom-color: var(--blood-color); }
        .secret-input::placeholder { color: #333; font-size: 2rem; letter-spacing: -3px; }

        .access-denied {
            animation: shake-screen 0.4s ease-in-out;
            border-bottom-color: red !important;
            color: red !important;
        }

/* --- [추가] 시크릿 기능 전용 스타일 --- */

/* 금기와 신념 박스 */
.belief-box {
    margin: 30px 0;
    padding: 20px;
    border-left: 5px solid var(--blood-color);
    background: linear-gradient(90deg, rgba(122, 26, 26, 0.1), transparent);
}
.belief-quote {
    font-family: var(--font-kr);
    font-size: 1.4rem;
    font-weight: 800;
    color: #fff;
    font-style: italic;
    margin-bottom: 10px;
    text-shadow: 0 0 5px rgba(0,0,0,0.8);
}
.belief-desc { color: #aaa; font-size: 0.95rem; }

/* 신문 기사 스크랩 효과 */
.news-scrap-container {
    background: #0f0f0f;
    border: 1px dashed #444;
    padding: 25px;
    margin-bottom: 30px;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
}
.news-scrap-item {
    background: #e6e6d8;
    color: #111;
    padding: 12px;
    width: 45%;
    min-width: 200px;
    font-size: 0.85rem;
    font-family: var(--font-kr);
    box-shadow: 3px 3px 8px rgba(0,0,0,0.6);
    line-height: 1.4;
    transform: rotate(-1deg);
}
.news-scrap-item:nth-child(even) { transform: rotate(1deg); background: #f0f0e8; }
.scrap-date { border-bottom: 1px solid #333; font-weight: bold; display: block; margin-bottom: 5px; font-size: 0.75rem; color: #444; }

/* 소지품 (2칸) */
.belongings-wrapper {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin: 30px 0;
    padding: 20px 0;
    border-top: 1px solid #333;
    border-bottom: 1px solid #333;
}
.belonging-slot {
    width: 140px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}
.belonging-img-box {
    width: 100px; height: 100px;
    border: 1px solid #555;
    background: #050505;
    display: flex; align-items: center; justify-content: center;
    color: #444; font-size: 0.8rem;
}
.belonging-name { color: #ddd; font-weight: bold; font-size: 1rem; margin-top: 5px; }
.belonging-desc { color: #777; font-size: 0.8rem; text-align: center; line-height: 1.3; }

/* 특성 및 역량 & 요구사항 */
.capability-section {
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid #333;
    padding: 20px;
    margin-bottom: 20px;
    color: #ccc;
    line-height: 1.8;
}
.final-req {
    text-align: right;
    font-family: var(--font-kr);
    color: var(--blood-color);
    font-weight: bold;
    font-size: 1.2rem;
    margin-top: 40px;
    border-top: 2px dashed var(--blood-color);
    padding-top: 15px;
    letter-spacing: 1px;
}
    </style>
</head>
<body>
<div class="intro-overlay" id="introLayer">
        <div id="runeContainer"></div>
        <div id="lightContainer"></div> <div class="sinking-text" id="introText">
            INTO THE ABYSS OF ADAM
        </div>

        <div class="lock-container" id="lockScreen">
            <div class="rune-circle">
                <span class="rune-icon">ᛟ</span> 
            </div>
            
            <div class="secret-input-box">
                <input type="text" id="gateKey" class="secret-input" placeholder="᛫᛫᛫᛫᛫" autocomplete="off">
            </div>
            <p style="color:#444; font-size: 0.8rem; margin-top: 20px; font-family: monospace;">
                <span id="statusText">AWAITING INPUT</span>
            </p>
        </div>
    </div>

    <div id="main-wrapper">

    <audio id="bgTheme" loop>
        <source src="" type="audio/mpeg"> 
    </audio>

    <div class="flash-overlay" id="flashOverlay"></div>
    <div class="shatter-overlay" id="shatterOverlay"></div>

    <div class="container">
        <header class="fade-in">
            <h1>APPLE</h1>
            <p class="subtitle">The Invitation from Adam City, 1914</p>
        </header>

        <section class="letter-section fade-in">
            <div id="typewriter"></div>
            <span class="cursor"></span>
        </section>
        
        <div class="section-divider"></div>

        <section class="newspaper-section fade-in">
            <div class="news-header">
                <span class="news-title">The Adam Chronicle</span>
                <span class="news-date">October 14th, 1914</span>
            </div>
            <div class="news-content">
                <p><span class="news-highlight">A</span>dam City's fog thickens as the missing persons count surpasses one hundred. Local authorities remain silent regarding the mysterious disappearances that have plagued the docklands since early September.</p>
                <p>"It's not just the fog," says a local fisherman who wished to remain anonymous. "Something moves within it. Shadows that don't belong to any man or beast." The police chief has dismissed these claims as mass hysteria caused by the recent industrial fumes.</p>
                <p>Meanwhile, the Lawton Hotel prepares to host a gathering of specialized individuals invited by the Mayor. Critics argue this is a desperate measure to control the situation that has clearly spiraled out of law enforcement's grasp.</p>
            </div>
        </section>

        <section class="worldview-section fade-in">
            <h3 class="worldview-title">About Adam City</h3>
            <div class="worldview-text">
                <p><strong>고립된 도시:</strong> 1914년, 거대한 안개 장벽에 의해 외부와 철저히 단절된 해상 도시입니다. 증기 기관과 초기 전기 문명이 기이하게 뒤틀려 발전했습니다.</p>
                <br>
                <p><strong>안개 (The Fog):</strong> 단순한 기상 현상이 아닙니다. 안개 속에서는 전파가 차단되고, 나침반이 돌며, 사람의 정신을 갉아먹는 환청이 들려옵니다. 시민들은 해가 지면 절대 문밖을 나서지 않습니다.</p>
            </div>
        </section>

        <section class="sanity-section fade-in">
            <h3 class="sanity-title">Delirium & Madness</h3>
            <p style="text-align: center; color: #aaa; margin-bottom: 20px;">
                "정신을 놓지 마십시오. 안개가 당신의 뇌를 파고들 것입니다."
            </p>

            <div class="sanity-meter-box">
                <div class="sanity-marker" style="left: 30%; border-color: red;" data-label="30"></div>
                <div class="sanity-marker" style="left: 60%;" data-label="60"></div>
                <div class="sanity-bar"></div>
            </div>

            <div class="sanity-desc-grid">
                <div class="sanity-stage">
                    <h4>기본 상태 (Sanity 100 ~ 61)</h4>
                    <p>안정적입니다. 하지만 안개 속에 오래 머물거나 충격적인 장면을 목격하면 수치는 서서히 감소합니다.</p>
                </div>
                <div class="sanity-stage">
                    <h4>1차 임계점 (Sanity 60 ~ 31)</h4>
                    <p>정신적 방어기제가 무너집니다. 환청과 환각이 시작되며, 특정 대상에 대한 <span class="warning-text">집착증(Obsession)</span>이나 <span class="warning-text">공포증(Phobia)</span>이 발현될 수 있습니다.</p>
                </div>
                <div class="sanity-stage" style="grid-column: 1 / -1; margin-top: 10px;">
                    <h4 style="color: var(--blood-color);">2차 임계점 (Sanity 30 ~ 0) - 위험(Critical)</h4>
                    <p>완전한 <span class="warning-text">광기(Madness)</span>의 영역입니다. 현실과 망상의 경계가 사라집니다. 통제 불가능한 폭력성을 보이거나, 자아를 상실하고 '괴물'과 다름없는 상태가 됩니다. 회복이 불가능할 수 있습니다.</p>
                </div>
            </div>
        </section>

<div class="map-section-container fade-in">
            <h3 class="map-title">CITY TOPOGRAPHY [HOLOGRAM]</h3>
            
            <div class="holo-stage">
                <div class="holo-grid-base"></div>
                
                <div class="holo-scan"></div>

                <div class="district-block d-north" onclick="goToDistrict('north')">
                    <span class="d-label">NORTH</span>
                </div>

                <div class="district-block d-west" onclick="goToDistrict('west')">
                    <span class="d-label">WEST</span>
                </div>

                <div class="district-block d-center" onclick="goToDistrict('center')">
                    <span class="d-label" style="color:#fff;">CENTER</span>
                </div>

                <div class="district-block d-east" onclick="goToDistrict('east')">
                    <span class="d-label">EAST</span>
                </div>

                <div class="district-block d-south" onclick="goToDistrict('south')">
                    <span class="d-label">SOUTH</span>
                </div>
            </div>
            
            <p style="text-align: center; color: #555; margin-top: 50px; font-size: 0.8rem;">
                * Click on a sector to access detailed information.
            </p>
        </div>

        <div class="section-divider"></div>

        <section class="districts-section fade-in">
            <h2>The Districts</h2>
            <div class="tabs">
                <button class="tab-btn active" onclick="openDistrict('center')">중앙 (Center)</button>
                <button class="tab-btn" onclick="openDistrict('east')">동부 (East)</button>
                <button class="tab-btn" onclick="openDistrict('west')">서부 (West)</button>
                <button class="tab-btn" onclick="openDistrict('south')">남부 (South)</button>
                <button class="tab-btn" onclick="openDistrict('north')">북부 (North)</button>
            </div>

            <div id="center" class="tab-content active">
                <div class="img-placeholder district-img-box">
                    </div>
                <h3 class="tab-title">중앙 (Central Adam)</h3>
                <p>애덤 시의 심장부. 시청과 주요 공공 시설이 밀집해 있는 번화가입니다.</p>
                <br>
                <ul>
                    <li>- <strong>로턴 스트리트 (Lawton St):</strong> 해결사들이 머물게 될 <span class="keyword">로턴 호텔(Lawton Hotel)</span>이 위치함.</li>
                    <li>- <strong>주요 시설:</strong> 시청, 경찰서, 소방서, 기차역.</li>
                    <li>- 가장 정돈되어 있으나, 밤이면 묘한 정적이 흐르는 곳.</li>
                </ul>
            </div>
            <div id="east" class="tab-content">
                <div class="img-placeholder district-img-box"></div>
                <h3 class="tab-title">동부 (East Adam)</h3>
                <p>기이한 분위기의 항구 도시. 외곽에는 악취와 이끼가 가득합니다.</p>
                <br>
                <ul>
                    <li>- <strong>주요 거리:</strong> 이스트 애덤 스트리트, 플리트 스트리트.</li>
                    <li>- <strong>특이점:</strong> 도시 설립 이전부터 존재한 '오래된 등대'.</li>
                    <li>- <strong>최근 사건:</strong> 의문의 <span class="keyword">연쇄 살인 사건</span> 발생.</li>
                </ul>
            </div>
            <div id="west" class="tab-content">
                <div class="img-placeholder district-img-box"></div>
                <h3 class="tab-title">서부 (West Adam)</h3>
                <p>하얀색 건물들이 늘어선 고풍스러운 부촌. 겉보기엔 가장 평화롭고 세련된 곳입니다.</p>
                <br>
                <ul>
                    <li>- <strong>시설:</strong> 고급 쇼핑 시설, 대학, 병원, 교회.</li>
                    <li>- <strong>최근 사건:</strong> <span class="keyword">사이비 종교</span>의 포교 활동. 백의를 입은 사제들 출몰.</li>
                </ul>
            </div>
            <div id="south" class="tab-content">
                <div class="img-placeholder district-img-box"></div>
                <h3 class="tab-title">남부 (South Adam)</h3>
                <p>미로처럼 얽힌 붉은 벽돌의 공장 단지. 매연과 소음이 끊이지 않는 곳입니다.</p>
                <br>
                <ul>
                    <li>- <strong>분위기:</strong> 산업혁명 초기의 혼란스러움과 빈민가.</li>
                    <li>- <strong>구조:</strong> 외부인은 길을 잃기 쉬운 복잡한 미로 구조.</li>
                    <li>- <strong>최근 사건:</strong> 노동자와 거주민들의 <span class="keyword">실종 사건</span>.</li>
                </ul>
            </div>
            <div id="north" class="tab-content">
                <div class="img-placeholder district-img-box"></div>
                <h3 class="tab-title">북부 (North Adam)</h3>
                <p>낮에는 평범해 보이지만, 밤이 되면 본색을 드러내는 무법지대이자 환락의 도시.</p>
                <br>
                <ul>
                    <li>- <strong>시설:</strong> 도박장, 카지노, 암시장, 만물상(텔러).</li>
                    <li>- <strong>세력:</strong> 마피아 조직과 갱단이 지배함.</li>
                    <li>- <strong>정보:</strong> 바(Bar) '올드 아담'에서 은밀한 정보가 거래됨.</li>
                </ul>
            </div>
        </section>

        <div class="section-divider"></div>

        <section class="lawton-section fade-in">
            <h2 class="lawton-title">로턴 호텔 <span>(Lawton Hotel)</span></h2>
            
            <div class="img-placeholder hotel-main-img">
                </div>

            <div class="hotel-intro-text">
                <p>
                    1890년 준공. 애덤 시의 역사와 함께해 온 유서 깊은 호텔입니다.<br>
                    빅토리아 양식의 고풍스러운 외관과 삐걱거리는 마호가니 바닥은<br>
                    지난 세월의 흔적을 고스란히 간직하고 있습니다.
                </p>
                <br>
                <p>
                    이곳은 시장의 초대를 받은 여러분을 위한 유일한 안식처이자,<br>
                    어떤 세력의 간섭도 받지 않는 <strong>'중립 지대'</strong>입니다.<br>
                    로비에서는 언제나 따뜻한 커피와 시가 향기를 맡으실 수 있습니다.
                </p>
            </div>

            <div class="hotel-features">
                <div class="feature-item">
                    <span class="feature-icon">Est. 1890</span>
                    <span class="feature-desc">Historic Building</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">Neutral Zone</span>
                    <span class="feature-desc">No Violence Inside</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">Concierge</span>
                    <span class="feature-desc">24h Service</span>
                </div>
            </div>
        </section>

<section class="deduction-section fade-in">
            <h2 class="system-title">SYSTEM <span>Observation & Deduction</span></h2>
            
            <div class="mechanic-container">
                <div class="mechanic-box">
                    <h3 class="mech-header">「 관찰 」</h3>
                    <p class="mech-desc">
                        오감을 통한 대상의 단편적 정보 감지.<br>
                        (시각, 청각, 후각, 미각, 촉각)
                    </p>
                    <div class="clue-list">
                        <div class="clue-item">'갈라진 입술'</div>
                        <div class="clue-item">'빈 약봉투'</div>
                        <div class="clue-item">'떨리는 근육'</div>
                        <div class="clue-item">'식은 땀'</div>
                    </div>
                </div>

                <div class="mechanic-arrow">▶</div>

                <div class="mechanic-box">
                    <h3 class="mech-header">「 추론 」</h3>
                    <p class="mech-desc">
                        관찰된 정보를 바탕으로<br>
                        대상의 숨겨진 상태와 정보를 서술.
                    </p>
                    <div class="deduction-result">
                        "대상은 현재 극도의 불안 상태이며,<br>
                        약물 금단 증상을 겪고 있음이 확실하다."
                    </div>
                </div>
            </div>
        </section>

        <div class="section-divider"></div>
        <div class="mid-phrase-container fade-in" onclick="triggerTotalDestruction()">
            <p class="mid-phrase glitch-target">썩은 사과도 사과다.</p>
        </div>
        <div class="section-divider"></div>

        <section class="hotel-section fade-in">
            <h2>Guest Registry</h2>
            <p class="hotel-desc">Lawton Hotel - Fixers List<br><strong>2 Rooms per Floor</strong></p>
            
            <div class="guest-grid" id="guest-list">
                </div>
        </section>

<div class="section-divider"></div>

        <section class="input-section fade-in">
            <h3 class="input-title">Send Transmission to Mayor</h3>
            <div class="terminal-box">
                <textarea class="terminal-input" id="userMessage" placeholder="이곳에 시장에게 보낼 답신이나 암호를 입력하십시오..."></textarea>
                <button class="transmit-btn" onclick="sendTransmission()">Transmit</button>
                <div class="response-msg" id="transmissionResponse"></div>
            </div>
        </section>

        <footer>
            <p>© 1914 Adam City Administration. All rights reserved.</p>
            <p>Beware of the fog.</p>
            <div class="fog-container">
                <div class="fog-img"></div>
                <div class="fog-img-2"></div>
            </div>
        </footer>

        <div class="modal-overlay" id="cardModal" onclick="closeModal(event)">
            <div class="business-card" onclick="event.stopPropagation()">
                <span class="close-btn" onclick="closeModalDirect()">×</span>
                
                <div class="card-info-side">
                    <div class="card-header">
                        <div class="card-name" id="modalName">Name</div>
                        <div class="card-role" id="modalRole">Role</div>
                    </div>
                    
                    <div class="card-body-row">
                        <span class="card-label">AGE</span>
                        <span class="card-value" id="modalAge">20s</span>
                    </div>
                    <div class="card-body-row">
                        <span class="card-label">GENDER</span>
                        <span class="card-value" id="modalGender">Female</span>
                    </div>
                    <div class="card-body-row">
                        <span class="card-label">SPECIALTY</span>
                        <span class="card-value" id="modalSpecialty">Unknown</span>
                    </div>
                    <div class="card-body-row">
                        <span class="card-label">NOTES</span>
                        <span class="card-value" id="modalDistinct">No specific records.</span>
                    </div>
                    <div class="card-body-row" style="margin-top: 15px;">
                        <span class="card-label" style="color:var(--blood-color)">REQUEST</span>
                        <span class="card-value redacted" id="modalRequest">This information is classified</span>
                    </div>
                </div>

                <div class="card-img-side">
                    <div class="img-placeholder card-portrait-box" id="modalImgContainer"></div>
                    <div class="card-room-number" id="modalRoom">RM.000</div>
                </div>
            </div>
        </div>
    </div>

<div class="secret-overlay" id="forbiddenOverlay">
    <div class="secret-interface">
        <div class="secret-header-bar">
            <h1 class="secret-title">ADAM : CLASSIFIED</h1>
            <button class="secret-close-btn" onclick="closeSecretOverlay('forbiddenOverlay')">CLOSE</button>
        </div>
        <div class="secret-tabs">
            <button class="secret-tab-btn active" onclick="openSecretTab('history')">애덤 시의 역사</button>
            <button class="secret-tab-btn" onclick="openSecretTab('stats')">통계 자료</button>
            <button class="secret-tab-btn" onclick="openSecretTab('anomalies')">특이사항</button>
        </div>
        <div class="secret-body">
            <div id="history" class="secret-chapter active">
                <h3 class="chapter-title">Chapter 1. Genesis of Fog</h3>
                <div class="secret-img-box img-placeholder" style="display:flex; justify-content:center; align-items:center; color:#555;">[ARCHIVE IMAGE]</div>
                <div class="secret-text">
                    <p>1890년, 초대 시장 '애덤'에 의해 해상 도시 건설 프로젝트가 시작되었다. 표면적인 목적은 무역의 요충지였으나, <span class="secret-highlight">실제 목적은 해저에서 발견된 고대 유적을 은폐하고 연구하기 위함이었다.</span></p>
                    <p>1909년, 제1차 안개 경보 발령. 연구 시설의 폭발 사고로 인해 도시 전체가 영구적인 안개에 휩싸였다. 외부와의 통신이 두절되었으며, 도시는 고립된 생태계가 되었다.</p>
                </div>
            </div>
            <div id="stats" class="secret-chapter">
                <h3 class="chapter-title">Chapter 2. Statistics</h3>
                <div class="secret-text">
                    <p><strong>- 현재 생존 인구:</strong> 12,403명 (급격한 감소세)</p>
                    <p><strong>- 실종자 누계:</strong> 1,092명</p>
                    <p><strong>- 사망자 누계:</strong> 4,500명 이상 (추정)</p>
                    <p><strong>- 미해결 강력 사건:</strong> 892건</p>
                    <br>
                    <p class="warning-text">※ 경고: 하수구 및 항구 인근에서 신원 미상의 훼손된 사체가 지속적으로 발견됨. 실제 피해 규모는 통계를 초월함.</p>
                </div>
            </div>
            <div id="anomalies" class="secret-chapter">
                <h3 class="chapter-title">Chapter 3. Anomalies</h3>
                <div class="secret-text">
                    <p>1. <strong>그림자 인간:</strong> 안개 농도가 짙은 날, 사람의 형상을 한 그림자가 목격됨. 물리적 실체가 없음.</p>
                    <p>2. <strong>집단 환각:</strong> 서부 지구 거주민들이 동시에 같은 꿈(물에 잠기는 꿈)을 꾸는 현상 보고.</p>
                    <p>3. <strong>시간의 왜곡:</strong> 로턴 호텔 내부와 외부의 시간 흐름이 일치하지 않는 현상이 간헐적으로 발생.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="sacrifice-overlay" id="sacrificeOverlay">
    <div class="sacrifice-nav">
        <h2 class="sacrifice-title">FILE: SACRIFICE (FIXER DATABASE)</h2>
        <button class="sacrifice-close" onclick="closeSecretOverlay('sacrificeOverlay')">EXIT DATABASE</button>
    </div>
    
    <div class="file-list-view" id="sacrificeFileList">
        </div>

    <div class="file-detail-view" id="sacrificeFileDetail">
        <button class="back-btn" onclick="backToFileList()">◀ BACK TO LIST</button>
        <div id="wikiContainer"></div>
    </div>
</div>

<div class="secret-overlay" id="easterEggOverlay" style="background: #000;">
    <div class="secret-interface" style="border-color: #fff; box-shadow: none;">
        <div class="secret-header-bar" style="background: #000; border-bottom: 1px dashed #fff;">
            <h1 class="secret-title" style="color: #fff; text-shadow: none;">PALETTE_DEV_MODE</h1>
            <button class="secret-close-btn" style="color:#fff; border-color:#fff;" onclick="closeSecretOverlay('easterEggOverlay')">SHUTDOWN</button>
        </div>
        
        <div style="padding: 20px; border-bottom: 1px solid #333; font-family: monospace; color: #0f0; min-height:100px;">
            <div id="paletteTypewriter"></div>
        </div>

        <div class="secret-tabs" style="background: #000;">
            <button class="secret-tab-btn" onclick="openEggTab('eggEnding')">ENDING</button>
            <button class="secret-tab-btn" onclick="openEggTab('eggRlyeh')">R'lyeh</button>
            <button class="secret-tab-btn" onclick="openEggTab('eggLoc')">LOCATIONS</button>
            <button class="secret-tab-btn" onclick="openEggTab('eggBehind')">BEHIND</button>
        </div>

        <div class="secret-body" style="background: #111;">
            <div id="eggEnding" class="secret-chapter active">
                <h3 class="chapter-title" style="border-color: #fff; color: #fff;">POSSIBLE ENDINGS</h3>
                <ul style="color: #ccc; line-height: 2; list-style: square; padding-left: 20px;">
                    <li>★ <strong>TRUE ENDING:</strong> 1 Route (조건: 기억 완전 회복 및 '심연' 도달)</li>
                    <li>☆ <strong>HAPPY ENDING:</strong> 1 Route (조건: 안개 정화 장치 가동)</li>
                    <li>■ <strong>NORMAL ENDING:</strong> 2 Routes (도시 탈출 또는 생존)</li>
                    <li>☠ <strong>BAD ENDING:</strong> ??? Routes (사망, 광기, 실종, 제물...)</li>
                </ul>
            </div>

            <div id="eggRlyeh" class="secret-chapter">
                <h3 class="chapter-title" style="border-color: #50ffaa; color: #50ffaa;">TRUTH: R'lyeh</h3>
                <p class="secret-text" style="color: #88ffcc;">
                    애덤 시의 지하 깊은 곳, 기반암 아래에는 고대 도시 <strong>'르뤼에(R'lyeh)'</strong>의 일부가 잠들어 있습니다.<br>
                    안개는 그곳에서 뿜어져 나오는 숨결이며, 시장 이안은 그 힘을 이용하려다 통제권을 잃었습니다.<br>
                    해결사들은 자신들도 모르는 사이에 고대의 존재를 깨우는 제물이 될 수도 있습니다.
                </p>
            </div>

            <div id="eggLoc" class="secret-chapter">
                <div style="margin-bottom: 20px;">
                    <button class="tab-btn" onclick="switchLoc('lighthouse')">LIGHTHOUSE</button>
                    <button class="tab-btn" onclick="switchLoc('fraction')">FRACTION</button>
                    <button class="tab-btn" onclick="switchLoc('alley')">ALLEY</button>
                </div>
                <div id="locContent">
                    </div>
            </div>

            <div id="eggBehind" class="secret-chapter">
                <h3 class="chapter-title" style="border-color: #fff; color: #fff;">BEHIND THE SCENES</h3>
                <p class="secret-text">
                    이 사이트는 PV 형식으로 제작되었으며, 1914년의 아날로그 감성과 코즈믹 호러를 결합하는 데 중점을 두었습니다.<br>
                    사용된 폰트와 노이즈 효과, 그리고 숨겨진 요소들은 플레이어의 불안정한 정신 상태를 대변합니다.
                </p>
            </div>
        </div>
    </div>
</div>

    </div> <script>
        // ==========================================
        // 1. 기본 데이터 및 설정
        // ==========================================
        
        // 타자기 텍스트
        const letterText = `친애하는 해결사 여러분.

저는 애덤 시(Adam City)의 시장, 이안입니다.
1914년, 우리의 도시는 기이한 병에 걸렸습니다.

항구의 어업과 산업, 관광으로 번영했던 이 도시는
1909년부터 시작된 알 수 없는 살인, 실종, 그리고 '현상'들로 인해
천천히 죽어가고 있습니다.

여러분은 각자의 분야에서 최고의 실력을 가진 분들입니다.
로턴 호텔에 여장을 푸시고, 부디 이 도시를 구원해주십시오.

보수는 섭섭지 않게 챙겨드리겠습니다.
행운을 빕니다.

- Adam City Mayor, Ian.`;

        // 메인 해결사 데이터
        const guests = [
            { room: "702", name: "이브", role: "화가", age: "19", gender: "Female", specialty: "기억 형상화", distinct: "항상 손에 물감이 묻어있음. 백색 머리칼.", request: "붉은 안료를 구해달라고 요청함.", desc: "여성 / 백색 머리 & 붉은 눈 / 유명 화가", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/F/25.webp", fileImg: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/logo/eve.png" },
            { room: "701", name: "스텔라", role: "경찰", age: "21", gender: "Female", specialty: "수사 및 사격", distinct: "제복 착용. 오드아이의 시선이 불안함.", request: "서장의 행방을 쫓고 있음.", desc: "여성 / 금발 / 오드아이 / 제복 착용", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/D/25.webp", fileImg: "" },
            { room: "601", name: "루트", role: "물리학 교수", age: "22", gender: "Female", specialty: "공간 물리학", distinct: "신임 교수. 푸른 머리카락을 묶고 있음.", request: "안개의 성분 분석 데이터를 요구함.", desc: "여성 / 푸른 머리 / 오드아이 / 신임 교수", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/C/25.webp", fileImg: "" },
            { room: "402", name: "왓슨", role: "조수", age: "20", gender: "Female", specialty: "응급 처치", distinct: "시안의 조수. 자색 눈동자가 특징.", request: "시안 탐정의 약을 구하고 있음.", desc: "여성 / 자색 머리 & 눈 / 시안의 조수", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/B/25.webp", fileImg: "" },
            { room: "401", name: "시안", role: "탐정", age: "20", gender: "Female", specialty: "추리 및 심문", distinct: "영국 출신 명탐정. 흑발 금안.", request: "살인 사건 현장의 출입 권한.", desc: "여성 / 흑발 / 금안 / 영국 명탐정", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/A/25.webp", fileImg: "" },
            { room: "302", name: "하이디", role: "기자", age: "20", gender: "Female", specialty: "정보 수집", distinct: "뉴욕 타임즈 기자. 주황색 머리.", request: "호텔 내부의 도청 장치 유무 확인.", desc: "여성 / 주황 머리 / 청안 / 뉴욕 기자", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/E/25.webp", fileImg: "" },
            { room: "301", name: "루나", role: "연예인", age: "20", gender: "Female", specialty: "연기 및 매혹", distinct: "월드 스타. 백금발의 화려한 외모.", request: "자신의 스토커를 처리해달라고 함.", desc: "여성 / 백금발 / 자색 눈 / 월드 스타", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/K/25.webp", fileImg: "" },
            { room: "202", name: "르네", role: "정신과 의사", age: "23", gender: "Female", specialty: "심리 상담", distinct: "차분한 회색 머리. 안경 착용.", request: "환자들의 진료 기록부 회수.", desc: "여성 / 회색 머리 / 자색 눈", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/I/25.webp", fileImg: "" },
            { room: "201", name: "노아", role: "기술자", age: "19", gender: "Female", specialty: "기계 수리", distinct: "멜빵바지. 기름 냄새.", request: "고장 난 발전기의 부품 조달.", desc: "여성 / 푸른 머리 & 눈 / 멜빵바지", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/G/25.webp", fileImg: "" },
            { room: "102", name: "카론", role: "고고학자", age: "22", gender: "Female", specialty: "고대어 해독", distinct: "백발의 노학자. 지팡이 사용.", request: "지하 유적지로 가는 지도를 원함.", desc: "여성 / 백발 / 청안 / 유명 학자", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/H/25.webp", fileImg: "" },
            { room: "101", name: "사프카", role: "첩보원", age: "21", gender: "Female", specialty: "암호 해독", distinct: "미국 정보국 소속. 갈색 머리.", request: "항구의 밀수품 목록 원본.", desc: "여성 / 갈색 머리 / 녹안 / 미국 요원", img: "https://raw.githubusercontent.com/palette-cyan/apple/refs/heads/main/J/25.webp", fileImg: "" },
            { room: "???", name: "{{user}}", role: "플레이어", age: "Unknown", gender: "Unknown", specialty: "Unknown", distinct: "기록 없음. 신원 미상.", request: "기억을 되찾길 원함.", desc: "기록 없음 / 신원 미상", isUser: true, img: "", fileImg: "" }
        ];

/* ====================================================== */
/* [데이터 교체] SACRIFICE 상세 데이터베이스 (전체 캐릭터)    */
/* ====================================================== */
const sacrificeDatabase = {
    "이브": { 
        bio: "애덤 시 외부에서 초청된 천재 화가. 캔버스 밖의 현실보다 그림 속의 세계를 더 신뢰한다. 최근 그녀의 화풍이 기괴하게 변했다는 평이 지배적이다.",
        beliefQuote: "\"붉은색이 아니면, 그것은 죽은 그림이야.\"",
        beliefDesc: "[신념]: 예술을 위한 도덕적 결벽증 포기. 미(美)에 대한 집착.",
        newsClippings: [
            {date: "1912.05.12", text: "전시회 도중 관객 3명 집단 실신. 그림에서 비릿한 냄새가 난다는 증언."},
            {date: "1913.11.02", text: "젊은 화가 이브, 1년간의 잠적. 평론가들은 그녀가 '악마와 계약했다'고 혹평."}
        ],
        items: [
            {name: "마른 붓", desc: "끝이 갈라진 붓. 붉은 물감(혹은 혈액)이 말라붙어 있다."},
            {name: "스케치북", desc: "사람의 눈알과 팔다리가 뒤엉킨 기괴한 스케치."}
        ],
        traits: "<strong>[직관적 통찰]</strong>: 사물의 본질을 꿰뚫어봄.<br><strong>[정신 감응]</strong>: 타인의 감정을 색채로 시각화.",
        eval: "극심한 정서불안 상태. 허나 안개 속의 추상적인 공포를 구체적인 형상으로 포착할 수 있는 유일한 인물. (위험도: B+)",
        request: "(붉은 안료를 구해달라고 요청함)" 
    },
    "스텔라": { 
        bio: "과잉 진압으로 징계를 받은 전직 경관. 한쪽 눈을 잃은 후 의안을 착용했다. 정의관이 뒤틀려 있으며, 범죄자에게 자비가 없다.",
        beliefQuote: "\"법은 죽었지만, 죄는 남는다.\"",
        beliefDesc: "[신념]: 사적 제재를 통한 질서 확립. 악에는 더 큰 악으로.",
        newsClippings: [
            {date: "1910.08.XX", text: "마피아 은신처 단신 습격 사건. 조직원 전원 중태."},
            {date: "1911.01.15", text: "경찰청장, 과잉 수사 논란에 스텔라 경관 무기한 정직 처분."}
        ],
        items: [
            {name: "훼손된 배지", desc: "날카로운 것에 긁혀 번호를 알아볼 수 없는 경찰 배지."},
            {name: "마지막 탄환", desc: "탄두에 'Justice'라는 글자가 조잡하게 새겨진 탄환."}
        ],
        traits: "<strong>[사격술]</strong>: 움직이는 표적 명중률 98%.<br><strong>[강압 수사]</strong>: 공포를 이용한 정보 수집.",
        eval: "통제 불가능한 시한폭탄. 피아 식별에 주의 요망. 전투력은 최상위권이나 팀워크는 최악. (위험도: A)",
        request: "(서장의 행방을 쫓고 있음)" 
    },
    "루트": { 
        bio: "최연소 물리학 교수. 안개의 성분을 과학적으로 규명하려 한다. 모든 초자연적 현상을 수식으로 설명하려는 강박이 있다.",
        beliefQuote: "\"관측되지 않는 공포는 없다.\"",
        beliefDesc: "[신념]: 과학 만능주의. 미지의 존재에 대한 부정.",
        newsClippings: [
            {date: "1913.03.10", text: "대학 연구실 원인 불명의 폭발. 루트 교수, 기적적 생존."},
            {date: "1913.04.01", text: "'비유클리드 기하학의 현실 적용' 논문, 학계에서 파문."}
        ],
        items: [
            {name: "고장 난 나침반", desc: "바늘이 북쪽이 아닌 제멋대로 회전하는 나침반."},
            {name: "연구 노트", desc: "일반적인 수학 기호가 아닌 알 수 없는 문자가 섞인 수식."}
        ],
        traits: "<strong>[공학적 분석]</strong>: 구조물 및 장치 파악.<br><strong>[냉철함]</strong>: 감정에 휘둘리지 않는 판단.",
        eval: "호기심이 생존 본능을 앞서는 유형. 안개 정화 장치를 만들 수 있는 지식을 보유했으나, 실험을 위해 동료를 희생시킬 가능성 있음. (위험도: C)",
        request: "(안개의 성분 분석 데이터 요구)" 
    },
    "왓슨": { 
        bio: "시안 탐정의 조수이자 전직 군의관. 겉보기엔 유약해 보이지만, 해부학적 지식과 살인 기술을 동시에 가지고 있다.",
        beliefQuote: "\"그녀는 나의 눈이고, 나는 그녀의 손이다.\"",
        beliefDesc: "[신념]: 시안에 대한 맹목적 헌신과 보호.",
        newsClippings: [
            {date: "1908.XX.XX", text: "왕립 의과대학 수석 졸업자 명단."},
            {date: "1909.12.25", text: "전장에서 동료를 업고 귀환한 '전장의 천사' 소문."}
        ],
        items: [
            {name: "수술용 메스", desc: "항상 날카롭게 관리된 은색 메스."},
            {name: "회중시계", desc: "시안의 것과 똑같은 시각을 가리키는 시계."}
        ],
        traits: "<strong>[응급 처치]</strong>: 전문적인 외상 치료.<br><strong>[CQC]</strong>: 근접 격투술 및 제압.",
        eval: "시안의 안위가 최우선 순위. 시안이 위험해지면 가장 위험한 살인 병기로 돌변함. (위험도: B-)",
        request: "(시안 탐정의 약을 구하고 있음)" 
    },
    "시안": {
        bio: "영국에서 건너온 명탐정. 뛰어난 추리력을 가졌으나, 너무 많은 것을 알고 있는 탓에 약물 없이는 신경쇠약을 견디지 못한다.",
        beliefQuote: "\"모든 퍼즐에는 반드시 조각이 있다.\"",
        beliefDesc: "[신념]: 진실에 대한 병적인 강박과 논리.",
        newsClippings: [
            {date: "1912.10.04", text: "런던의 연쇄 살인마 검거. 탐정 시안의 추리가 빛을 발하다."},
            {date: "1914.01.01", text: "명탐정 시안, 건강 악화로 요양차 도항 소식."}
        ],
        items: [
            {name: "파이프 담배", desc: "불이 꺼진 지 오래된 고급 파이프."},
            {name: "진통제", desc: "라벨이 뜯겨진 빈 약병. 가루가 남아있다."}
        ],
        traits: "<strong>[초추리]</strong>: 단서 조합 및 사건 재구성.<br><strong>[약물 의존]</strong>: 주기적인 섭취 없이는 패닉 상태.",
        eval: "논리가 통하지 않는 '비상식(코즈믹 호러)'적 상황에서 가장 먼저 무너질 수 있음. 왓슨의 케어가 필수적. (위험도: C+)",
        request: "(살인 사건 현장의 출입 권한)"
    },
    "하이디": { 
        bio: "뉴욕 타임즈 소속 기자. 특종을 위해서라면 불법적인 일도 서슴지 않는다. 애덤 시의 비밀을 폭로하여 퓰리처상을 노리고 있다.",
        beliefQuote: "\"펜은 칼보다 강하다. 잉크가 마르기 전까진.\"",
        beliefDesc: "[신념]: 알 권리와 진실 보도 제일주의.",
        newsClippings: [
            {date: "1913.06.15", text: "상원의원 스캔들 폭로 기사. 뉴욕 전체가 발칵 뒤집히다."},
            {date: "1914.02.XX", text: "하이디 기자, 취재 도중 무단 가택 침입으로 고소."}
        ],
        items: [
            {name: "소형 카메라", desc: "렌즈에 금이 갔지만 작동하는 카메라."},
            {name: "속기 수첩", desc: "자신만 알아볼 수 있는 암호로 가득 찬 수첩."}
        ],
        traits: "<strong>[잠입]</strong>: 보안 시설 침투 및 은신.<br><strong>[속기]</strong>: 빠른 정보 기록 및 요약.",
        eval: "정보 수집 능력은 탁월하나 입이 가벼움. 비밀 유지에 취약하며 돌발 행동을 할 가능성이 높음. (위험도: B)",
        request: "(호텔 내부의 도청 장치 유무 확인)" 
    },
    "루나": { 
        bio: "세기의 여배우. 화려한 외모 뒤에 지독한 관심 결핍과 나르시시즘이 숨어있다. 최근 스토커에게 시달리며 신경이 예민해져 있다.",
        beliefQuote: "\"영원히 나만 바라봐요. 눈을 떼지 마.\"",
        beliefDesc: "[신념]: 세상의 중심은 자신. 타인은 관객일 뿐.",
        newsClippings: [
            {date: "1913.12.31", text: "주연 영화 '달의 눈물', 역대 최고 흥행 기록 갱신."},
            {date: "1914.03.10", text: "루나의 분장실에서 핏빛 장미꽃다발 발견. 스토커의 소행?"}
        ],
        items: [
            {name: "진주 목걸이", desc: "알이 굵은 진주 목걸이. 개중 몇 개는 가짜다."},
            {name: "팬레터 뭉치", desc: "'사랑해, 죽여버리고 싶을 만큼'이라고 적힌 섬뜩한 편지들."}
        ],
        traits: "<strong>[매혹]</strong>: 타인의 호감을 사거나 정보를 캐냄.<br><strong>[연기]</strong>: 거짓말과 감정 위장.",
        eval: "대중을 선동하는 능력이 있음. 시민들을 규합하거나 혼란에 빠뜨리는 '스피커' 역할로 활용 가능. (위험도: A)",
        request: "(자신의 스토커를 처리해달라고 함)" 
    },
    "르네": { 
        bio: "정신과 전문의. 환자를 치료하기보다 인간의 심리가 무너지는 과정을 관찰하는 것을 즐기는 듯한 소문이 있다.",
        beliefQuote: "\"마음은 뇌라는 감옥에 갇힌 죄수일 뿐.\"",
        beliefDesc: "[신념]: 감정의 화학적 해석. 인간성 배제.",
        newsClippings: [
            {date: "1910.XX.XX", text: "정신병원 폐쇄 병동 환자 집단 탈주 사건."},
            {date: "1911.XX.XX", text: "르네 박사, 비윤리적 최면 치료 의혹으로 조사받아."}
        ],
        items: [
            {name: "최면용 추", desc: "규칙적으로 흔들리는 은제 펜듈럼."},
            {name: "진료 기록부", desc: "환자들의 트라우마와 약점이 상세히 적힌 장부."}
        ],
        traits: "<strong>[심리 분석]</strong>: 상대의 약점 파악.<br><strong>[최면]</strong>: 일시적인 기억 조작 및 암시.",
        eval: "아군의 멘탈을 케어할 수도, 붕괴시킬 수도 있는 양날의 검. 사디즘 성향 의심됨. (위험도: S)",
        request: "(환자들의 진료 기록부 회수)" 
    },
    "노아": { 
        bio: "천재적인 재능을 가진 어린 기술자. 사람보다 기계를 더 편하게 생각한다. 애덤 시의 복잡한 하수도와 배관 구조를 꿰뚫고 있다.",
        beliefQuote: "\"기계는 거짓말 안 해요. 고장 날 뿐이지.\"",
        beliefDesc: "[신념]: 기계적 인과관계에 대한 신뢰.",
        newsClippings: [
            {date: "1912.09.09", text: "15세 소년, 대학 입학 거부하고 정비소 취직 화제."},
            {date: "1914.05.05", text: "항구의 거대 크레인, 노아의 손에서 3시간 만에 수리 완료."}
        ],
        items: [
            {name: "만능 렌치", desc: "손때가 까맣게 묻은, 묵직한 렌치."},
            {name: "지하 설계도", desc: "복잡한 미로 같은 애덤 시의 지하 배관 청사진."}
        ],
        traits: "<strong>[공학]</strong>: 기계 수리 및 조작.<br><strong>[해킹]</strong>: 전자 잠금 장치 해제.",
        eval: "도시의 인프라를 장악하는 데 필수적인 인재. 육체적 전투력은 낮으나 활용 가치는 매우 높음. (위험도: D)",
        request: "(고장 난 발전기의 부품 조달)" 
    },
    "카론": { 
        bio: "저명한 고고학자였으나 학계에서 추방당한 노학자. 애덤 시 지하에 묻힌 고대 문명을 찾기 위해 평생을 바쳤다.",
        beliefQuote: "\"과거를 잊은 자에게 미래는 없다. 다만 파멸뿐.\"",
        beliefDesc: "[신념]: 금지된 지식에 대한 탐구욕.",
        newsClippings: [
            {date: "1899.XX.XX", text: "이집트 발굴팀 전원 실종. 카론 박사만 홀로 귀환."},
            {date: "1905.XX.XX", text: "'초고대 문명설' 주장하다 학회에서 제명."}
        ],
        items: [
            {name: "지팡이", desc: "손잡이에 날카로운 칼날이 숨겨진 지팡이."},
            {name: "고대 석판 조각", desc: "해독할 수 없는 문자가 새겨진 돌조각."}
        ],
        traits: "<strong>[고대어 해독]</strong>: 유적의 문자 해석.<br><strong>[생존 본능]</strong>: 숱한 탐사에서 살아남은 감각.",
        eval: "도시의 기원과 '안개'의 정체에 가장 근접한 인물. 르뤼에의 존재를 알고 있을 가능성 99%. (위험도: A)",
        request: "(지하 유적지로 가는 지도)" 
    },
    "사프카": { 
        bio: "미국 정보국 소속 첩보원이었으나 현재는 이중간첩 의혹을 받고 있다. 생존을 위해서라면 누구와도 손을 잡고 배신한다.",
        beliefQuote: "\"충성은 비싼 곳에 바친다.\"",
        beliefDesc: "[신념]: 철저한 이기주의와 생존.",
        newsClippings: [
            {date: "1913.XX.XX", text: "정보국 기밀 문서 유출 사건 발생."},
            {date: "1914.XX.XX", text: "인터폴, 코드네임 'S'에 대한 적색 수배령."}
        ],
        items: [
            {name: "위조 여권", desc: "다양한 국적과 이름이 적힌 여권 뭉치."},
            {name: "독극물 앰플", desc: "즉사할 수 있는 청산가리 앰플. 자살용? 타살용?"}
        ],
        traits: "<strong>[변장]</strong>: 타인으로 완벽하게 위장.<br><strong>[암호학]</strong>: 통신 도청 및 암호 해독.",
        eval: "가장 신뢰할 수 없는 인물. 허나 외부와 통신할 수 있는 유일한 수단을 가지고 있을지도 모름. (위험도: B+)",
        request: "(항구의 밀수품 목록 원본)" 
    },
    "{{user}}": {
        bio: "데이터 없음. 시스템 오류. 존재하지 않아야 할 데이터입니다.",
        beliefQuote: "\"...\"",
        beliefDesc: "기록 없음.",
        newsClippings: [{date: "ERROR", text: "해당 인물에 대한 기록을 찾을 수 없습니다."}],
        items: [{name: "초대장", desc: "피 묻은 초대장. 수신인 이름이 번져 있다."}, {name: "녹슨 열쇠", desc: "어디에 쓰는지 알 수 없는 낡은 열쇠."}],
        traits: "<strong>[변수]</strong>: 모든 예측을 벗어난 존재.<br><strong>[선택]</strong>: 운명을 바꿀 권한.",
        eval: "모든 시나리오의 예외 사항. 이 세계의 관측자이자 개입자. (위험도: UNKNOWN)",
        request: "(기억을 되찾길 원함)"
    }
};

// [데이터 추가] 이스터에그 장소 데이터
const easterEggData = {
    lighthouse: {
        title: "THE LIGHTHOUSE",
        desc: "도시의 가장 높은 곳. 하지만 불빛은 바다가 아닌 도시 안쪽을 비추고 있다. 등대지기는 10년째 실종 상태다."
    },
    fraction: {
        title: "THE FRACTION",
        desc: "현실과 환상이 겹쳐지는 파편화된 공간. 이곳에서는 중력이 올바르게 작용하지 않는다. 유리의 파편 속에 다른 차원이 비친다."
    },
    alley: {
        title: "DARK ALLEY",
        desc: "아무도 지나가지 않는 뒷골목. 벽에는 'PALETTE'라는 그래피티가 그려져 있다. 쥐들도 이곳을 피해 다닌다."
    }
};

/* ====================================================== */
/* [수정] 2. 기능 구현 함수들 (새로 추가/수정된 부분)        */
/* ====================================================== */

// 공통: 오버레이 열기/닫기
function openSecretOverlay(id) { document.getElementById(id).classList.add('open'); }
function closeSecretOverlay(id) { document.getElementById(id).classList.remove('open'); }

// 1. FORBIDDEN (탭 전환)
function openSecretTab(tabId) {
    document.querySelectorAll('#forbiddenOverlay .secret-chapter').forEach(el => el.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    document.querySelectorAll('#forbiddenOverlay .secret-tab-btn').forEach(btn => btn.classList.remove('active'));
    event.currentTarget.classList.add('active');
}

// 2. SACRIFICE (리스트 렌더링 및 상세 보기)
function renderSacrificeList() {
    const listContainer = document.getElementById('sacrificeFileList');
    listContainer.innerHTML = ''; 
    guests.forEach(guest => {
        const folder = document.createElement('div');
        folder.className = 'file-folder-btn';
        folder.onclick = () => openSacrificeDetail(guest.name);
        folder.innerHTML = `
            <div class="folder-img-box">
                ${guest.fileImg ? `<img src="${guest.fileImg}" class="folder-img">` : '<span style="font-size:2rem;">📁</span>'}
            </div>
            <span style="font-size:0.9rem;">${guest.name}</span>
        `;
        listContainer.appendChild(folder);
    });
}

function openSacrificeDetail(name) {
    // 데이터베이스에서 정보 찾기 (없으면 유저 정보로 대체)
    const db = sacrificeDatabase[name] || sacrificeDatabase["{{user}}"]; 
    const container = document.getElementById('wikiContainer');
    
    // HTML 조립
    let newsHTML = '';
    if(db.newsClippings) {
        db.newsClippings.forEach(news => {
            newsHTML += `<div class="news-scrap-item"><span class="scrap-date">${news.date}</span>${news.text}</div>`;
        });
    }

    let itemsHTML = '';
    if(db.items) {
        db.items.forEach(item => {
            itemsHTML += `
                <div class="belonging-slot">
                    <div class="belonging-img-box">IMG</div>
                    <div class="belonging-name">${item.name}</div>
                    <div class="belonging-desc">${item.desc}</div>
                </div>
            `;
        });
    }

    container.innerHTML = `
        <h2 class="wiki-name-title">${name}</h2>
        <div class="wiki-section-title">BIO</div>
        <div class="wiki-text">${db.bio}</div>

        <div class="belief-box">
            <div class="belief-quote">${db.beliefQuote}</div>
            <div class="belief-desc">${db.beliefDesc}</div>
        </div>

        <div class="wiki-section-title">RECORDS (NEWS)</div>
        <div class="news-scrap-container">${newsHTML}</div>

        <div class="wiki-section-title">BELONGINGS</div>
        <div class="belongings-wrapper">${itemsHTML}</div>

        <div class="wiki-section-title">EVALUATION</div>
        <div class="capability-section">
            <p>${db.traits}</p>
            <hr style="border-color:#444; margin:10px 0;">
            <p>${db.eval}</p>
        </div>

        <div class="final-req">REQUEST: ${db.request}</div>
    `;

    document.getElementById('sacrificeFileList').style.display = 'none';
    document.getElementById('sacrificeFileDetail').classList.add('active');
}

function backToFileList() {
    document.getElementById('sacrificeFileDetail').classList.remove('active');
    document.getElementById('sacrificeFileList').style.display = 'grid';
}

// 3. EASTER EGG (PALETTE)
function startPaletteTypewriter() {
    const text = "To. Players.\n\n이곳까지 도달하셨군요.\n애덤 시는 여러분의 선택에 따라 수많은 평행세계로 분기됩니다.\n부디, 진실을 마주하시길.\n\nFrom. PALETTE";
    const el = document.getElementById('paletteTypewriter');
    el.innerHTML = "";
    let i = 0;
    function typing() {
        if (i < text.length) {
            el.innerHTML += text.charAt(i) === '\n' ? '<br>' : text.charAt(i);
            i++;
            setTimeout(typing, 50);
        }
    }
    typing();
}

function openEggTab(tabId) {
    document.querySelectorAll('#easterEggOverlay .secret-chapter').forEach(el => el.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
}

function switchLoc(locKey) {
    const data = easterEggData[locKey];
    const container = document.getElementById('locContent');
    container.innerHTML = `
        <div class="secret-img-box img-placeholder" style="border-color:#fff; color:#fff;">
             [IMAGE: ${data.title}]
        </div>
        <h4 style="color:#fff; margin-bottom:10px; font-size:1.5rem;">${data.title}</h4>
        <p class="secret-text" style="color:#ccc;">${data.desc}</p>
    `;
}

        // ==========================================
        // 2. 초기화 및 기본 기능 (Basic Functions)
        // ==========================================
        
        let i = 0;
        const typeWriterElement = document.getElementById('typewriter');

        function typeWriter() {
            if (i < letterText.length) {
                typeWriterElement.innerHTML += letterText.charAt(i) === '\n' ? '<br>' : letterText.charAt(i);
                i++;
                setTimeout(typeWriter, 50); 
            } else {
                document.querySelector('.cursor').style.display = 'none';
            }
        }

        function openDistrict(districtName) {
            const contents = document.getElementsByClassName('tab-content');
            const buttons = document.getElementsByClassName('tab-btn');
            for (let content of contents) content.classList.remove('active');
            for (let btn of buttons) btn.classList.remove('active');
            document.getElementById(districtName).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function renderGuests() {
            const guestListContainer = document.getElementById('guest-list');
            guestListContainer.innerHTML = "";
            guests.forEach((guest, index) => {
                const card = document.createElement('div');
                card.className = guest.isUser ? 'guest-card user-card' : 'guest-card';
                card.style.cursor = 'pointer'; 
                card.onclick = () => openModal(index); 

                const imgHTML = (guest.img && guest.img.trim() !== '') ? `<img src="${guest.img}" alt="${guest.name}">` : ``; 

                card.innerHTML = `
                    <div class="img-placeholder card-img-box">${imgHTML}</div>
                    <div class="room-number">${guest.room}</div>
                    <div class="guest-info">
                        <div class="guest-name">${guest.name}</div>
                        <span class="guest-role">${guest.role}</span>
                        <div class="guest-details"><span>${guest.desc}</span></div>
                    </div>
                `;
                guestListContainer.appendChild(card);
            });
        }

        function observeFadeIn() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('visible');
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
        }

        function triggerRandomGlitch() {
            const targets = document.querySelectorAll('p, li, h1, h2, h3, .guest-name, .guest-role, .mid-phrase');
            if (targets.length === 0) return;
            const randomTarget = targets[Math.floor(Math.random() * targets.length)];
            randomTarget.classList.add('glitch-active');
            setTimeout(() => { randomTarget.classList.remove('glitch-active'); }, Math.random() * 400 + 100);
            setTimeout(triggerRandomGlitch, Math.random() * 1500 + 500);
        }

        function triggerTotalDestruction() {
            const body = document.body;
            const flash = document.getElementById('flashOverlay');
            const shatter = document.getElementById('shatterOverlay');
            flash.classList.add('boom');
            body.classList.add('shake-screen');
            setTimeout(() => { shatter.classList.add('active'); }, 50);
            setTimeout(() => { body.classList.remove('shake-screen'); body.classList.add('destroyed'); }, 500);
        }

        function tryPlayBGM() {
            const bgAudio = document.getElementById('bgTheme');
            if (bgAudio.paused) {
                bgAudio.play().catch(error => console.log("BGM Waiting for interact"));
            }
        }
        document.addEventListener('click', tryPlayBGM, { once: true });


        // ==========================================
        // 3. 기능: 명함 팝업 (Modal)
        // ==========================================
        const modal = document.getElementById('cardModal');
        
        function openModal(index) {
            const data = guests[index];
            document.getElementById('modalName').textContent = data.name;
            document.getElementById('modalRole').textContent = data.role;
            document.getElementById('modalAge').textContent = data.age;
            document.getElementById('modalGender').textContent = data.gender;
            document.getElementById('modalSpecialty').textContent = data.specialty;
            document.getElementById('modalDistinct').textContent = data.distinct;
            document.getElementById('modalRequest').textContent = data.request; 
            document.getElementById('modalRoom').textContent = "RM." + data.room;

            const imgContainer = document.getElementById('modalImgContainer');
            if (data.img && data.img.trim() !== '') {
                imgContainer.innerHTML = `<img src="${data.img}" alt="${data.name}">`;
            } else {
                imgContainer.innerHTML = ''; 
            }
            modal.classList.add('active');
        }

        function closeModal(event) { if (event.target === modal) modal.classList.remove('active'); }
        function closeModalDirect() { modal.classList.remove('active'); }


        /* ====================================================== */
/* [중요] 메시지 전송 함수 교체 (시크릿 코드 감지 기능)      */
/* ====================================================== */
function sendTransmission() {
    const inputField = document.getElementById('userMessage');
    const responseField = document.getElementById('transmissionResponse');
    const btn = document.querySelector('.transmit-btn');
    
    const rawMsg = inputField.value.trim(); // 원본 메시지
    const upperMsg = rawMsg.toUpperCase();  // 대문자 변환

    if (rawMsg === "") {
        inputField.style.borderColor = "red";
        setTimeout(() => { inputField.style.borderColor = "#444"; }, 500);
        return;
    }

    // --- 시크릿 코드 감지 ---

    // 1. FORBIDDEN
    if (upperMsg === 'FORBIDDEN') {
        openSecretOverlay('forbiddenOverlay');
        inputField.value = "";
        return;
    }

    // 2. SACRIFICE
    if (upperMsg === 'SACRIFICE') {
        renderSacrificeList();
        openSecretOverlay('sacrificeOverlay');
        inputField.value = "";
        return;
    }

    // 3. 썩은 사과 (이스터에그)
    if (rawMsg === '썩은 사과도 사과다.' || rawMsg === '썩은 사과도 사과다') {
        openSecretOverlay('easterEggOverlay');
        startPaletteTypewriter();
        switchLoc('lighthouse'); 
        inputField.value = "";
        return;
    }

    // --- 일반 전송 ---
    btn.disabled = true;
    btn.textContent = "SENDING...";
    responseField.textContent = "Connecting to private frequency...";
    responseField.classList.add('show');

    setTimeout(() => {
        inputField.value = "";
        btn.textContent = "SENT";
        btn.style.borderColor = "#333"; 
        btn.style.color = "#333";
        
        responseField.innerHTML = "<span style='color:var(--blood-color)'>[SYSTEM]:</span> 수신 확인됨. 당신의 의지는 기록되었습니다.";
        triggerRandomGlitch();

        setTimeout(() => { 
            btn.disabled = false; 
            btn.textContent = "TRANSMIT"; 
            btn.style = ""; 
            responseField.classList.remove('show'); 
        }, 3000);
    }, 1500);
}


// --- [추가] 지도 클릭 시 해당 구역 탭으로 이동 및 스크롤 ---
        function goToDistrict(districtId) {
            // 1. 기존 openDistrict 함수 호출하여 탭 전환
            openDistrict(districtId);

            // 2. 해당 섹션으로 부드럽게 스크롤 이동
            const districtsSection = document.querySelector('.districts-section');
            districtsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }


/* =========================================
           [추가된 코드] 인트로 및 잠금 해제 로직
           ========================================= */
        
        const runes = ['ᚠ', 'ᚢ', 'ᚦ', 'ᚨ', 'ᚱ', 'ᚲ', 'ᚷ', 'ᚹ', 'ᚺ', 'ᚾ', 'ᛁ', 'ᛃ', 'ᛇ', 'ᛈ', 'ᛉ', 'ᛊ', 'ᛏ', 'ᛒ', 'ᛖ', 'ᛗ', 'ᛚ', 'ᛜ', 'ᛟ', 'ᛞ'];
        const introLayer = document.getElementById('introLayer');
        const lockScreen = document.getElementById('lockScreen');
        const runeContainer = document.getElementById('runeContainer');
        const lightContainer = document.getElementById('lightContainer');
        const introText = document.getElementById('introText');
        const gateKey = document.getElementById('gateKey');
        const mainWrapper = document.getElementById('main-wrapper');
        const statusText = document.getElementById('statusText');
        
        let introInterval;
        let lightInterval;

        function startIntro() {
            // 1) 룬 문자 생성
            introInterval = setInterval(() => {
                const rune = document.createElement('div');
                rune.classList.add('floating-rune');
                rune.innerText = runes[Math.floor(Math.random() * runes.length)];
                rune.style.left = Math.random() * 100 + 'vw';
                rune.style.fontSize = (Math.random() * 2 + 1) + 'rem';
                
                const duration = Math.random() * 5 + 8;
                rune.style.animationDuration = duration + 's';
                
                runeContainer.appendChild(rune);
                setTimeout(() => { rune.remove(); }, duration * 1000);
            }, 150);

            // 2) 불길한 청록색 빛 (단일, 느린 빈도)
            spawnSingleLight(); // 첫 실행
            lightInterval = setInterval(spawnSingleLight, 3500); // 3.5초마다

            function spawnSingleLight() {
                const light = document.createElement('div');
                light.classList.add('distant-light');
                
                light.style.left = Math.random() * 100 + 'vw';
                light.style.top = Math.random() * 100 + 'vh';
                
                const scale = Math.random() * 0.8 + 0.2; 
                const blur = (1 - scale) * 5; 
                light.style.transform = `scale(${scale})`;
                light.style.filter = `blur(${blur}px)`;

                const duration = Math.random() * 0.5 + 2.5;
                light.style.animationDuration = duration + 's';
                
                lightContainer.appendChild(light);
                setTimeout(() => { light.remove(); }, duration * 1000);
            }

            // 15초 후 잠금 화면으로 전환
            setTimeout(() => {
                clearInterval(introInterval);
                clearInterval(lightInterval);
                introText.style.display = 'none';
                runeContainer.innerHTML = '';
                lightContainer.innerHTML = '';
                
                lockScreen.style.display = 'flex';
                gateKey.focus();
            }, 15000); 
        }

        // 패스워드 입력 감지
        gateKey.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const input = gateKey.value.trim().toUpperCase();
                if (input === 'APPLE') {
                    // 성공: 잠금 해제
                    statusText.style.color = '#fff';
                    statusText.innerText = "ACCESS GRANTED";
                    
                    introLayer.classList.add('hidden');
                    
                    setTimeout(() => {
                        introLayer.style.display = 'none';
                        mainWrapper.classList.add('unlocked'); 
                        
                        // [중요] 타자기 효과와 페이드인 시작 (화면 깨짐 효과는 뺌)
                        typeWriter(); 
                        observeFadeIn(); 
                        setTimeout(triggerRandomGlitch, 1000);
                    }, 1000);

                } else {
                    // 실패: 에러 효과
                    gateKey.classList.add('access-denied');
                    gateKey.value = "";
                    statusText.style.color = "red";
                    statusText.innerText = "ᛖᚱᚱᛟᚱ : ᛞᛖᚾᛁᛖᛞ"; 
                    setTimeout(() => {
                        gateKey.classList.remove('access-denied');
                        statusText.style.color = "#444";
                        statusText.innerText = "AWAITING INPUT";
                    }, 800);
                }
            }
        });

        // [중요] 통합 초기화 함수
        // 기존의 window.addEventListener('load', ...) 대신 이것을 사용합니다.
        window.onload = function() {
            startIntro(); // 인트로 시작
            renderGuests(); // 게스트 리스트 생성
            // observeFadeIn, typeWriter 등은 잠금 해제 후 실행됨
        };
    </script>
</body>
</html>